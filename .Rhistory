assert_that(nrow(Pos_count) > 0)
rare_iSNPs <- Pos_count %>% filter(n<=rare_cutoff) %>%
.$Position
common_iSNPs <- Pos_count %>% filter(n>rare_cutoff) %>%
.$Position
subject_id = 26
num_rare = length(rare_iSNPs)
num_common = length(common_iSNPs)
print(paste("Rare iSNP cutoff = ",rare_cutoff))
print(paste("num rare iSNPs = ",num_rare))
print(paste("num common iSNPs = ",num_common))
fastgear_fiji_recombs <- read.delim("~/GitHub/Ct_MAP_analysis/fastgear_fiji_recombs") %>%
select(Start,End,...1,...2,...3)
fastgear_fiji_recombs <- read.delim("~/GitHub/Ct_MAP_analysis/fastgear_fiji_recombs") %>%
select(Start,End,...1,...2,...3)
print("Recombination block cutoff = 3")
assert_that(nrow(fastgear_fiji_recombs) > 0)
colnames(fastgear_fiji_recombs) <- c("Start","End","c1","c2","c3")
R_name = paste0(subject_id,"R")
V_name = paste0(subject_id,"V")
C_name = paste0(subject_id,"C")
C_recomb <- recomb_coords(fastgear_fiji_recombs,C_name)
R_recomb <- recomb_coords(fastgear_fiji_recombs,R_name)
V_recomb <- recomb_coords(fastgear_fiji_recombs,V_name)
C_recomb_bases <- length(C_recomb)
R_recomb_bases <- length(R_recomb)
V_recomb_bases <- length(V_recomb)
print(paste("Num bases in C recomb blocks= ",C_recomb_bases))
print(paste("Num bases in R recomb = blocks",R_recomb_bases))
print(paste("Num bases in V recomb = blocks",V_recomb_bases))
print(paste("Coverage cutoff = ",cov_cutoff))
R_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"R_MAP.txt"),"R") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent)
assert_that(nrow(R_MAP) > 0)
R_bases <- nrow(R_MAP)
print(paste("Numbers of R bases above cutoff is ",R_bases))
C_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"C_MAP.txt"),"C") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent)
assert_that(nrow(C_MAP) > 0)
C_bases <- nrow(C_MAP)
print(paste("Numbers of C bases above cutoff is ",C_bases))
V_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"V_MAP.txt"),"V") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent)
assert_that(nrow(V_MAP) > 0)
V_bases <- nrow(V_MAP)
print(paste("Numbers of V bases above cutoff is ", V_bases))
Total_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
inner_join(.,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 90 & SNP_percent.y > 90 & SNP_percent > 90)) %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare_SNV",
Position %in% common_iSNPs ~ "common_SNV",
TRUE ~ "fixed_SNP"
)) %>%
mutate(fastGEAR = ifelse(Position %in% c(R_recomb,C_recomb,V_recomb),"fastGEAR_block","other")) %>%
add_column(subject_id = subject_id)
colnames(Total_iSNPs) <- c("Position","R_percent","V_percent","C_percent","SNP","fastGEAR_block", "subject_id")
outfile2 <- paste0("./iSNPs_by_subject/iSNPs_subject_",subject_id,".tsv")
write_tsv(Total_iSNPs,outfile2)
assert_that(nrow(Total_iSNPs) > 0)
print(paste("Number of iSNP positions = ",nrow(Total_iSNPs)))
library(cowplot)
RCplot <- ggplot(filter(Total_iSNPs,!(R_percent > 90 & C_percent > 90)), aes(x=R_percent, y=C_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
RVplot <- ggplot(filter(Total_iSNPs,!(R_percent > 90 & V_percent > 90)), aes(x=R_percent, y=V_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
VCplot <- ggplot(filter(Total_iSNPs,!(V_percent > 90 & C_percent > 90)), aes(x=V_percent, y=C_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
try1_title <- ggdraw() +
draw_label(paste(subject_id),
fontface = 'bold',
x = 0,
hjust = 0) +
theme(plot.margin = margin(0, 0, 0, 7))
tryptich1 <- plot_grid(
try1_title,RCplot, RVplot, VCplot,
labels = c("","a","b","c")
)
T1T2_denovo_snps <- read_lines("T1T2_snps_denovo.list")
T1T2_denovo_df <- full_join(R_MAP,V_MAP, by = "Position") %>%
full_join(.,C_MAP, by = "Position") %>%
filter(Position %in% T1T2_denovo_snps)
colnames(T1T2_denovo_df) <- c("Position","Rectum","Vagina","Endocervix")
T1T2_denovo_df_long <- gather(T1T2_denovo_df,"Body_site","SNP_percent",-Position)
CSNP_plot1 <- ggparcoord(data = T1T2_denovo_df,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2,
title = paste0("cDenovo_SNPs for" ,subject_id))
library(RColorBrewer)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[1]) +
xlim(1,1042504)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[2]) +
xlim(1,1042504)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[3]) +
xlim(1,1042504)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
CSNP_plot2 <- plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v',labels = c('d', 'e','f'),vjust = 0.1)
CSNP_plot3 <- plot_grid(snps_ref4, ncol = 1, align = 'v',labels = c('g'),vjust = 0.2,hjust = 0.2)
print(paste("Number cDenovo Ref SNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix > 90))))
print(paste("Number cDenovo Non-Ref SNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix < 10))))
print(paste("Number cDenovo iSNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix >= 10 & Endocervix <= 90))))
print(paste("Number cDenovo Ref SNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum > 90))))
print(paste("Number cDenovo Non-Ref SNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum < 10))))
print(paste("Number cDenovo iSNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum >= 10 & Rectum <= 90))))
print(paste("Number cDenovo Ref SNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina > 90))))
print(paste("Number cDenovo Non-Ref SNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina < 10))))
print(paste("Number cDenovo iSNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina >= 10 & Vagina <= 90))))
list(tryptich1,CSNP_plot1,CSNP_plot2,CSNP_plot3)
CSNP_plot1 <- ggparcoord(data = T1T2_denovo_df,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2,
title = paste0("cDenovo_SNPs for" ,subject_id))
library(ggparcoord)
library(GGally)
CSNP_plot1 <- ggparcoord(data = T1T2_denovo_df,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2,
title = paste0("cDenovo_SNPs for" ,subject_id))
library(RColorBrewer)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[1]) +
xlim(1,1042504)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[2]) +
xlim(1,1042504)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[3]) +
xlim(1,1042504)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
CSNP_plot2 <- plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v',labels = c('d', 'e','f'),vjust = 0.1)
CSNP_plot3 <- plot_grid(snps_ref4, ncol = 1, align = 'v',labels = c('g'),vjust = 0.2,hjust = 0.2)
print(paste("Number cDenovo Ref SNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix > 90))))
print(paste("Number cDenovo Non-Ref SNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix < 10))))
print(paste("Number cDenovo iSNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix >= 10 & Endocervix <= 90))))
print(paste("Number cDenovo Ref SNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum > 90))))
print(paste("Number cDenovo Non-Ref SNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum < 10))))
print(paste("Number cDenovo iSNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum >= 10 & Rectum <= 90))))
print(paste("Number cDenovo Ref SNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina > 90))))
print(paste("Number cDenovo Non-Ref SNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina < 10))))
print(paste("Number cDenovo iSNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina >= 10 & Vagina <= 90))))
list(tryptich1,CSNP_plot1,CSNP_plot2,CSNP_plot3)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
?plot_grid()
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 26)
library(tidyverse)
res_files <- list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
View(res_table)
library(tidyverse)
source("MAP_functions.R")
list_of_87 <- read.delim("list_87_strains.txt", header = F)
View(list_of_87)
View(list_of_87)
list_of_87 <- read.delim("list_87_strains.txt", header = F)
list_77 <- filter(list_of_87, !V1 %in% c("486C","486V","589C","600C","600V","648V","680C","680V","699C","699V"))
MAP_minor_alleles_df <- read.delim("~/GitHub/Ct_MAP_analysis/MAP_minor_alleles_df2.tsv") %>%
mutate(strain = sub("-WGS","",strain)) %>%
mutate(strain = sub("Rs","R",strain)) %>%
mutate(strain = sub("Vs","V",strain)) %>%
mutate(subject = sub("C|R|V","",strain)) %>%
mutate(site = substr(strain,nchar(strain),nchar(strain))) %>%
filter(strain %in% list_77$V1)
MAP_minor_alleles_df %>%
group_by(strain) %>%
tally
Pos_count <- MAP_minor_alleles_df %>%
group_by(Position) %>%
tally
write_tsv(Pos_count,"Pos_count.tsv")
Pos_count %>%
filter(n < 11) %>%
tally()
Pos_count %>%
mutate(rare = ifelse(n < 4,"yes","no")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("gainsboro","red")) +
geom_vline(xintercept = 3, color = "red", linetype = "dotted") +
theme_bw()
ggplot(filter(Pos_count,n > 10),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,5) +
theme_bw()
ggplot(Pos_count,aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1176V"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1176V Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "32V"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("32V Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1182R"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1182R Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1078V"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1078V Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1079R"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1079R Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1176R"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1176R Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
View(Pos_count)
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 1201)
SNP_analysis_for_pub(subject_id = 32)
SNP_analysis_for_pub(subject_id = 1176)
?ggsave2
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 1201)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 1201)
SNP_analysis_for_pub(subject_id = 32)
SNP_analysis_for_pub(subject_id = 1176)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 1201)
SNP_analysis_for_pub(subject_id = 32)
SNP_analysis_for_pub(subject_id = 1176)
SNP_analysis_for_pub(subject_id = 564)
SNP_analysis_for_pub(subject_id = 1078)
Pos_count %>%
filter(n == 1) %>%
tally()
temp1 <- c(33,35,37,38,39)
temmp2 <- c(24,44,53,56)
t.test(temp1.temp2)
t.test(temp1,temp2)
t.test(temp1,temmp2)
res <- t.test(temp1,temmp2)
str(res)
res$p.value
library(tidyverse)
res_files <- list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
write_tsv(res_table,"./iSNP_analysis_table/all_results_table.tsv")
grand_summary <- read.delim("./2021_08_24-Grand_Summary - MAP_analysis_summary.tsv")
list_of_87 <- read.delim("list_87_strains.txt", header = F)
mean_doc <- grand_summary %>%
mutate(Sample = sub("-WGS","",Sample)) %>%
mutate(Sample = sub("Rs","R",Sample)) %>%
mutate(Sample = sub("Vs","V",Sample)) %>%
filter(Sample %in% list_of_87$V1) %>%
select(Sample,Subject,Body.Site,Mean.depth.of.coverage,intermediate_SNPs)
#Figure W3
ggplot(mean_doc,aes(x=Body.Site,y=Mean.depth.of.coverage)) +
geom_boxplot() +
theme_bw()
ggplot(mean_doc,aes(x=Mean.depth.of.coverage,y=intermediate_SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of intermediate SNPs versus sample depth of coverage")
RI_SNPs <- res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(RI_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of rare intermediate SNPs versus sample depth of coverage")
RI_SNPs %>% filter(Mean.depth.of.coverage > 1000) %>%
filter(SNPs > 0)
F_SNPs <- res_table %>%
select(subject_name,RonlyF,ConlyF,VonlyF) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyF" ~ paste0(subject_name,"R"),
site == "ConlyF" ~ paste0(subject_name,"C"),
site == "VonlyF" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(F_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of fixed SNPs versus sample depth of coverage")
View(F_SNPs)
View(res_table)
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv")
View(Supplemental_Table_3)
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv") %>%
select(1..5)
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv") %>%
select(c(1..5))
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv") %>%
select(c(1:5))
View(Supplemental_Table_3)
View(res_table)
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv") %>%
select(c(1:5))
Supp_Table_3_res <- inner_join(Supplemental_Table_3,res_table, by = c("Participant"="subject_name"))
View(Supp_Table_3_res)
gpA_rectal_fixed <- Supplemental_Table_3 %>%
filter(Group == "A" | RonlyF > 0)
gpA_rectal_fixed <- Supplemental_Table_3 %>%
filter(Group == "A")
gpA_rectal_fixed <- Supplemental_Table_3 %>%
filter(Group == "A") %>%
filter(RonlyF > 0)
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0)
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0)
View(gpA_rectal_fixed)
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_vaginal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(VonlyF > 0) %>%
nrow()
gpA_endocervical_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(ConlyF > 0) %>%
nrow()
Pos_count %>%
filter(n < 4) %>%
tally()
View(res_table)
res_files <- list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
res_table <- read.delim(res_files[1])
res_files[1]
res_files <- list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
gpA_R_fixed_rareC <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF_CIrare > 0 | RonlyF_CandVIrare > 0) %>%
nrow()
