Total_iSNPs %>% filter(C_percent > 12.5 & C_percent < 45 & R_percent > 30 & R_percent < 75) %>%
ggplot(aes(x=Position)) +
geom_histogram(binwidth = 1000) +
theme_light() +
xlim(1,1042504)+
xlab("Position") +
ylab("Count") +
ggtitle("Histogram of positions < 90%")
Total_iSNPs %>% filter(C_percent > 60 & C_percent < 101 & R_percent > 30 & R_percent < 75) %>%
ggplot(aes(x=Position)) +
geom_histogram(binwidth = 1000) +
theme_light() +
xlim(1,1042504)+
xlab("Position") +
ylab("Count") +
ggtitle("Histogram of positions < 90%")
install.packages("GGally")
library(GGally)
ggparcoord(data = filter(Total_iSNPs,C_percent > 12.5 & C_percent < 45 & R_percent > 30 & R_percent < 75),
columns = 2:4)
ggparcoord(data = filter(Total_iSNPs,C_percent > 12.5 & C_percent < 45 & R_percent > 30 & R_percent < 75),
columns = 2:4,
scale = "globalminmax")
ggparcoord(data = filter(Total_iSNPs,C_percent > 12.5 & C_percent < 45 & R_percent > 30 & R_percent < 75),
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
ggparcoord(data = filter(Total_iSNPs,C_percent > 60 & C_percent < 101 & R_percent > 30 & R_percent < 75),
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
ggparcoord(data = filter(Total_iSNPs,C_percent > 12.5 & C_percent < 101 & R_percent > 30 & R_percent < 75),
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
Filtered_iSNPs <- Total_iSNPs %>% filter(C_percent > 12.5 & C_percent < 101 & R_percent > 30 & R_percent < 75) %>%
mutate(iSNP_class = case_when(V_percent > 80 & C_percent > 60 & C_percent < 80 ~ "class1",
V_percent > 55 & V_percent <80 & C_percent < 50 ~ "class2",
V_percent > 25 &C_percent < 40 ~ "class3",
TRUE ~ "other"))
View(Filtered_iSNPs)
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.15,
groupColumn = "iSNP_class") +
scale_color_brewer(palette = "Set2")
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.5,
groupColumn = "iSNP_class") +
scale_color_brewer(palette = "Set2")
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
Filtered_iSNPs <- Total_iSNPs %>% filter(C_percent > 12.5 & C_percent < 101 & R_percent > 30 & R_percent < 75) %>%
mutate(iSNP_class = case_when(V_percent > 80 & C_percent > 60 & C_percent < 80 ~ "class1",
V_percent > 55 & V_percent <80 & C_percent < 50 ~ "class2",
V_percent < 25 & C_percent < 40 ~ "class3",
TRUE ~ "other"))
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.5,
groupColumn = "iSNP_class") +
scale_color_brewer(palette = "Set2")
Filtered_iSNPs <- Total_iSNPs %>% filter(C_percent > 12.5 & C_percent < 101 & R_percent > 30 & R_percent < 75) %>%
mutate(iSNP_class = case_when(V_percent > 80 & C_percent > 60 & C_percent < 80 ~ "class1",
V_percent > 55 & V_percent <85 & C_percent < 50 ~ "class2",
V_percent < 25 & C_percent < 40 ~ "class3",
TRUE ~ "other"))
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.3,
groupColumn = "iSNP_class") +
scale_color_brewer(palette = "Accent")
ggplot(Filtered_iSNPs, aes(x=Position, color=iSNP_class)) +
geom_histogram(binwidth = 1000) +
scale_color_brewer(palette = "Accent") +
xlim(1,1042504)+
xlab("Position") +
ylab("Count") +
ggtitle("Chromosome position by group")
Filtered_iSNPs <- Total_iSNPs %>% filter(C_percent > 12.5 & C_percent < 101 & R_percent > 30 & R_percent < 75) %>%
mutate(iSNP_class = case_when(V_percent > 80 & C_percent > 60  ~ "class1",
V_percent > 55 & V_percent <85 & C_percent < 50 ~ "class2",
V_percent < 25 & C_percent < 40 ~ "class3",
TRUE ~ "other"))
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.3,
groupColumn = "iSNP_class") +
scale_color_brewer(palette = "Accent")
ggplot(Filtered_iSNPs, aes(x=Position, color=iSNP_class)) +
geom_histogram(binwidth = 1000) +
scale_color_brewer(palette = "Accent") +
xlim(1,1042504)+
xlab("Position") +
ylab("Count") +
ggtitle("Chromosome position by group")
Filtered_iSNPs <- Total_iSNPs %>% filter(C_percent > 12.5 & C_percent < 101 & R_percent > 30 & R_percent < 75) %>%
mutate(iSNP_class = case_when(V_percent > 80 & C_percent > 60  ~ "class1",
V_percent > 55 &  C_percent < 50 ~ "class2",
V_percent < 25 & C_percent < 40 ~ "class3",
TRUE ~ "other"))
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.3,
groupColumn = "iSNP_class") +
scale_color_brewer(palette = "Accent")
Filtered_iSNPs <- Total_iSNPs %>% filter(C_percent > 12.5 & C_percent < 101 & R_percent > 30 & R_percent < 75) %>%
mutate(iSNP_class = case_when(V_percent > 80 & C_percent > 60  ~ "class1",
V_percent > 55 &  C_percent < 50 ~ "class2",
V_percent < 50  ~ "class3",
TRUE ~ "other"))
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
ggparcoord(data = Filtered_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.3,
groupColumn = "iSNP_class") +
scale_color_brewer(palette = "Accent")
ggplot(Filtered_iSNPs, aes(x=Position, color=iSNP_class)) +
geom_histogram(binwidth = 1000) +
scale_color_brewer(palette = "Accent") +
xlim(1,1042504)+
xlab("Position") +
ylab("Count") +
ggtitle("Chromosome position by group")
library(tidyverse)
source("MAP_functions.R")
list_of_87 <- read.delim("list_87_strains.txt", header = F)
MAP_minor_alleles_df <- read.delim("~/GitHub/Ct_MAP_analysis/MAP_minor_alleles_df2.tsv") %>%
mutate(strain = sub("-WGS","",strain)) %>%
mutate(strain = sub("Rs","R",strain)) %>%
mutate(strain = sub("Vs","V",strain)) %>%
mutate(subject = sub("C|R|V","",strain)) %>%
mutate(site = substr(strain,nchar(strain),nchar(strain))) %>%
filter(strain %in% list_of_87$V1)
MAP_minor_alleles_df %>%
group_by(strain) %>%
tally
Pos_count <- MAP_minor_alleles_df %>%
group_by(Position) %>%
tally
write_tsv(Pos_count,"Pos_count.tsv")
ggplot()
Pos_count %>%
filter(n < 11) %>%
tally()
ggplot(Pos_count,aes(n)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
theme_bw()
ggplot(filter(Pos_count,n > 10),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,5) +
theme_bw()
ggplot(Pos_count,aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1176V"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1176V Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "32V"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("32V Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1182R"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1182R Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1078V"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1078V Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1079R"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1079R Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
ggplot(filter(MAP_minor_alleles_df,strain == "1176R"),aes(Position)) +
geom_histogram(binwidth=10000) +
ggtitle("1176R Minor alleles across the genome") +
xlim(1,1042519) +
ylim(0,450) +
theme_bw()
View(Pos_count)
Pos_count %>%
mutate(rare = ifelse(n < 4,1,0)) %>%
ggplot(aes(n, color = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("green", "purple")) +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,1,0)) %>%
ggplot(aes(n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("green", "purple")) +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,1,0))
Pos_count %>%
mutate(rare = ifelse(n < 4,1,0)) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("green", "purple")) +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,1,0)) %>%
ggplot(aes(x = n, color = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("green", "purple")) +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,"1","0")) %>%
ggplot(aes(x = n, color = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("green", "purple")) +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,"1","0")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("green", "purple")) +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,"1","0")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("red","gainsboro"))
Pos_count %>%
mutate(rare = ifelse(n < 4,"1","0")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("gainsboro","red")) +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,"1","0")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("gainsboro","red")) +
theme(legend. position = "none") +
Pos_count %>%
mutate(rare = ifelse(n < 4,"1","0")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("gainsboro","red")) +
theme(legend, position = "none") +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,"1","0")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("gainsboro","red")) +
theme(legend.position = "none") +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,"yes","no")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("gainsboro","red")) +
theme(legend.position = "none") +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,"yes","no")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("gainsboro","red")) +
geom_vline(xintercept = 3, color = "blue", linetype = "dotted") +
theme_bw()
Pos_count %>%
mutate(rare = ifelse(n < 4,"yes","no")) %>%
ggplot(aes(x = n, fill = rare)) +
geom_histogram(binwidth=1) +
ylab("Number of iSNPs") +
xlab("Number of strains") +
ggtitle("Figure_Y1 - How many strains were each iSNP found in?") +
scale_fill_manual(values = c("gainsboro","red")) +
geom_vline(xintercept = 3, color = "red", linetype = "dotted") +
theme_bw()
ggparcoord(data = Total_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
ggparcoord(data = Total_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.1)
?ggparcoord
parcoord_title <- paste("Subject",subject_id,"Number iSNPs =",nrow(Total_iSNPs))
ggparcoord(data = Total_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.1,
title = parcoord_title)
parcoord_title <- paste("Subject",subject_id,", number iSNPs =",nrow(Total_iSNPs))
ggparcoord(data = Total_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.1,
title = parcoord_title)
parcoord_title <- paste("Subject",subject_id,", number iSNPs =",nrow(Total_iSNPs))
ggparcoord(data = Total_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.05,
title = parcoord_title)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_pipeline(subject_id = 26)
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_pipeline(subject_id = 26)
SNP_analysis_pipeline(subject_id = 32)
SNP_analysis_pipeline(subject_id = 68)
SNP_analysis_pipeline(subject_id = 72)
SNP_analysis_pipeline(subject_id = 87)
SNP_analysis_pipeline(subject_id = 98)
SNP_analysis_pipeline(subject_id = 107)
SNP_analysis_pipeline(subject_id = 192)
SNP_analysis_pipeline(subject_id = 227)
SNP_analysis_pipeline(subject_id = 362)
SNP_analysis_pipeline(subject_id = 519)
SNP_analysis_pipeline(subject_id = 564)
SNP_analysis_pipeline(subject_id = 753)
SNP_analysis_pipeline(subject_id = 908)
SNP_analysis_pipeline(subject_id = 927)
SNP_analysis_pipeline(subject_id = 951)
SNP_analysis_pipeline(subject_id = 968)
SNP_analysis_pipeline(subject_id = 1077)
SNP_analysis_pipeline(subject_id = 1078)
SNP_analysis_pipeline(subject_id = 1079)
SNP_analysis_pipeline(subject_id = 1106)
SNP_analysis_pipeline(subject_id = 1145)
SNP_analysis_pipeline(subject_id = 1176)
SNP_analysis_pipeline(subject_id = 1182)
SNP_analysis_pipeline(subject_id = 1201)
SNP_analysis_pipeline(subject_id = 1226)
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt")
View(Tip_Labels_BigTree)
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE)
View(CT_Mapping_05_27)
View(CT_Mapping_05_27)
libary(tidyverse)
?grepl
libary(tidyverse)
library(tidyverse)
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt") %>%
filter(grepl("urogenital",Lineage))
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE)
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt") %>%
filter(grepl("urogenital",Lineage)) %>%
filter(grepl("^\\D",Lineage))
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE)
grepl("^\D",Tip_Labels_BigTree$Lineage)
grepl("^\\D",Tip_Labels_BigTree$Lineage)
grepl("^1",Tip_Labels_BigTree$Lineage)
grepl("1",Tip_Labels_BigTree$Lineage)
Tip_Labels_BigTree$Lineage
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt") %>%
filter(grepl("urogenital",Lineage)) %>%
filter(grepl("^\\D",taxa))
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE)
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt") %>%
filter(grepl("urogenital",Lineage)) %>%
filter(grepl("^\\D",taxa)) %>%
mutate(Clade = ifelse(grepl("Non",Lineage),"T2","T1"))
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE)
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt") %>%
filter(grepl("urogenital",Lineage)) %>%
filter(grepl("^\\D",taxa)) %>%
mutate(Clade = ifelse(grepl("Non",Lineage),"T2","T1"))
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE) %>%
select(filenm = V1,taxa = V2)
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt") %>%
filter(grepl("urogenital",Lineage)) %>%
filter(grepl("^\\D",taxa)) %>%
mutate(Clade = ifelse(grepl("Non",Lineage),"T2","T1"))
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE) %>%
select(filenm = V1,taxa = V2)
T1T2 <- inner_join(Tip_Labels_BigTree,CT_Mapping_05_27, by = "taxa")
View(T1T2)
fa_files <- list.file(path= "~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",pattern = "*.fa")
fa_files <- list.files(path= "~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",pattern = "*.fa")
fa_files
fa_files <- list.files(path= "~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes",pattern = "*.fa")
fa_files
fa_files <- list.files("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes",pattern = "*.fa")
fa_files <- list.files("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes",pattern = ".fa")
fa_files <- list.files("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes",pattern = ".+fa")
fa_files <- list.files(path = "~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes",pattern = "*")
fa_files <- list.files(path = "~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",pattern = "*fa",full.names = T)
fa_files <- list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",pattern = "*fa",full.names = T)
fa_files <- list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",full.names = T)
fa_files
list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",pattern = "*fa",full.names = T)
list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",pattern = "*fa",full.names = T)
list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/",full.names = T)
library(tidyverse)
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt") %>%
filter(grepl("urogenital",Lineage)) %>%
filter(grepl("^\\D",taxa)) %>%
mutate(Clade = ifelse(grepl("Non",Lineage),"T2","T1"))
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE) %>%
select(filenm = V1,taxa = V2)
T1T2 <- inner_join(Tip_Labels_BigTree,CT_Mapping_05_27, by = "taxa")
fa_files <- list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",pattern = "*fa",full.names = T)
list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
list.files("../../Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",full.names = T, pattern = "*fa")
list.files("../../Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/",full.names = T)
list.files("../../Documents/2021-Fiji-Ct_paper/Published_CT_Genomes",full.names = T)
list.files("../../Documents/2021-Fiji-Ct_paper/Published_CT_Genomes")
View(T1T2)
list.files("../../Documents/)
list.files("../../Documents/")
list.files("../../")
list.files("../../Downloads/")
list.files("../../")
list.files("../../Pictures/")
list.files("../../Desktop/")
list.files("../../Documents/")
Tip_Labels_BigTree <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/Tip_Labels_BigTree.txt") %>%
filter(grepl("urogenital",Lineage)) %>%
filter(grepl("^\\D",taxa)) %>%
mutate(Clade = ifelse(grepl("Non",Lineage),"T2","T1"))
CT_Mapping_05_27 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Published_CT_Genomes/CT_Mapping_05_27.txt", header=FALSE) %>%
select(filenm = V1,taxa = V2) %>%
mutate(filenm = gsub(".fa","",filenm))
T1T2 <- inner_join(Tip_Labels_BigTree,CT_Mapping_05_27, by = "taxa")
View(CT_Mapping_05_27)
