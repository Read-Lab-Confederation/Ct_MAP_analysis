filter(group == "Fiji") %>%
ggplot(aes(x=Num.of.Recombination.Blocks)) +
geom_histogram(color="black", fill="white") +
stat_bin(binwidth=1,geom="text", aes(label=..count..) , vjust = -1)
Gubbins_stats <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Gubbins/CT_Gubbins_184_05_22_MASKED.per_branch_statistics.csv") %>%
mutate(group = case_when(grepl("\\dV|\\dR|\\dC",Node) ~ "Fiji",
grepl("internal",Node) ~ "Internal",
TRUE ~ "Reference"))
Gubbins_stats_tips <- Gubbins_stats %>%
filter(group %in% c("Fiji","Reference"))
Gubbins_stats_tips %>%
filter(group == "Fiji") %>%
ggplot(aes(x=Num.of.Recombination.Blocks)) +
geom_histogram(color="black", fill="white") +
stat_bin(binwidth=1,geom="text", aes(label=..count..) , vjust = -1)
Gubbins_stats_tips %>%
filter(group == "Fiji") %>%
filter(Num.of.Recombination.Blocks > 0)
Gubbins_stats_tips %>%
filter(group == "Fiji") %>%
filter(Num.of.Recombination.Blocks > 0)  %>%
arrange(Node)
mat["32V",which(colnames(mat) %in% Ref_names)][order(mat["32V",which(colnames(mat) %in% Ref_names)])][c(1,2,3,4)]
mat[colnames(mat) == "32V",colnames(mat) == "1176V"]
mat <- as.matrix(read.table("/Users/timothyread/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Gubbins/filtered_polymorphic_sites.disty.matrix"))
mat[colnames(mat) == "32V",colnames(mat) == "1176V"]
colnames(mat)
mat[colnames(mat) == "X32V",colnames(mat) == "X1176V"]
library(Biostrings)
ir <- IRanges(start=10, end=100)
ir2 <- reduce(ir)
ir2
ir
ol <- findOverlaps(ir, reduce(ir))
ol
str(ol)
as.matrix(ol)
ir <- IRanges(start=10, end=100)
ir2 <- reduce(ir)
ol <- findOverlaps(ir, reduce(ir))
as.matrix(ol)
session()
session
sessionInfo()
View(Gubbins_Fiji)
set.seed(123)
mnames <- paste0("N",1:10)
testmat <- matrix(runif(100,1,100),nrow = 10,ncol = 10,dimnames=list(mnames,mnames))
testmat
lower.tri(testmat)
hclust(testmat)
testmat[rowSums(testmat<5)>0,colSums(testmat<5)>0]
testmat[rowSums(testmat<10)>0,colSums(testmat<10)>0]
upper.tr(testmat)
upper.tri(testmat)
diag(testmat)
upper.tri(testmat) <- NA
library(gdata)
install.packages("gdata")
library(gdata)
upperTriangle(testmat, diag = T) <- NA
testmat[rowSums(testmat<10)>0,colSums(testmat<10)>0]
testmat
? rowSums
rowSums(testmat<10)
rowSums(testmat<10, na.rm = T)
testmat[rowSums(testmat<10, na.rm =T)>0,colSums(testmat<10, na.rm=T)>0]
testmat2 <- matrix(runif(100,1,100),nrow = 10,ncol = 10,dimnames=list(mnames,mnames))
disttest <- dist(testmat2)
testmat2
disttest
hclust(disttest)
disttest2 <- as.dist(testmat2)
disttest2
testmat2
set.seed(123)
testmat2 <- matrix(runif(100,1,100),nrow = 10,ncol = 10,dimnames=list(mnames,mnames))
disttest2 <- as.dist(testmat2)
distclst2 <- hclust(disttest2)
cuttree(distclst2,10)
cutree(distclst2,10)
plot(distclst2)
?cuttree
?cutree
cutree(distclst2,h=10)
plot(distclst2)
cutree(distclst2,h=20)
distmat2
testmat2
table(cutree(distclst2,h=20))
library(tidyverse)
`1182R_potential_minors` <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_minors.tsv")
View(`1182R_potential_minors`)
rm(1182R_potential_minors`)
View(`1182R_potential_minors`)
View(`1182R_potential_minors`)
rm(`1182R_potential_minors`)
`Sub_1182R_potential_minors` <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_minors.tsv")
View(`1182R_potential_minors`)
`Sub_1182R_potential_minors` <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_minors.tsv")
View(Sub_1182R_potential_minors)
Sub_1182R_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_minors.tsv")
Sub_1182R_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_minors.tsv")
Sub_1182V_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182V_potential_minors.tsv")
Sub_1182R_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_minors.tsv")
Sub_1182V_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182V_potential_minors.tsv")
Sub_1182V_SNPs <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182V_potential_SNPs.tsv")
Sub_1182R_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_minors.tsv")
Sub_1182V_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182V_potential_minors.tsv")
Sub_1182V_SNPs <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182V_potential_SNPs.tsv")
Sub_1182R_SNPs <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_SNPs.tsv")
View(Sub_1182V_SNPs)
Sub_1182R_SNPs %>%
filter(Position %in% Sub_1182V_potential_minors$Position)
Sub_1182V_SNPs %>%
filter(Position %in% Sub_1182R_potential_minors$Position)
source("MAP_functions.R")
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(1182R_pos = ifelse(Position %in% Sub_1182R_potential_minors$Position,1,0))
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(pos1182R = ifelse(Position %in% Sub_1182R_potential_minors$Position,1,0))
View(partition_1182V_SNPs)
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(pos1182R = ifelse(Position %in% Sub_1182R_potential_minors$Position,1,0)) %>%
mutate(SNP_percent = round((Coverage-Ref_cov)/Coverage),1)
?round
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(pos1182R = ifelse(Position %in% Sub_1182R_potential_minors$Position,1,0)) %>%
mutate(SNP_percent = round((Coverage-Ref_cov)/Coverage),digits = 1)
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(pos1182R = ifelse(Position %in% Sub_1182R_potential_minors$Position,1,0)) %>%
mutate(SNP_percent = (Coverage-Ref_cov)/Coverage)
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(pos1182R = ifelse(Position %in% Sub_1182R_potential_minors$Position,1,0)) %>%
mutate(SNP_percent = round((Coverage-Ref_cov)/Coverage,digits=2))
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(pos1182R = ifelse(Position %in% Sub_1182R_potential_minors$Position,1,0)) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
ggplot(partition_1182V_SNPs,aes(x=SNP_percent, fill=pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2) +
ggtitle("1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=SNP_percent, fill=pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=SNP_percent,fill = as.factor(pos1182R))) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=Positiont,fill = as.factor(pos1182R))) +
geom_histogram(binwidth=1000, alpha=0.2, position="identity") +
ggtitle("1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=Position,fill = as.factor(pos1182R))) +
geom_histogram(binwidth=1000, alpha=0.2, position="identity") +
ggtitle("1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=Position,fill = as.factor(pos1182R))) +
geom_histogram(binwidth=10000, alpha=0.2, position="identity") +
ggtitle("1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=Position,fill = as.factor(pos1182R))) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("1182V SNPs by match to 1182R") +
theme_bw()
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(as.factor(pos1182R) = ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP")) %>%
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(pos1182R = ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP")) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
ggplot(partition_1182V_SNPs,aes(x=SNP_percent,fill = pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency pf 1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=Position,fill = as.factor(pos1182R))) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("Chromosome position of 1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=Position,fill = pos1182R)) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("Chromosome position of 1182V SNPs by match to 1182R") +
theme_bw()
Sub_1182R_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_minors.tsv")
Sub_1182V_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182V_potential_minors.tsv")
Sub_1182C_potential_minors <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182C_potential_minors.tsv")
Sub_1182V_SNPs <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182V_potential_SNPs.tsv")
Sub_1182R_SNPs <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182R_potential_SNPs.tsv")
Sub_1182C_SNPs <- read.delim("~/Documents/2021-Fiji-Ct_paper/MAP_results/1182C_potential_SNPs.tsv")
View(Sub_1182C_SNPs)
View(Sub_1182C_potential_minors)
ggplot(partition_1182V_SNPs,aes(x=Position,fill = pos1182R)) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("Chromosome position of 1182V SNPs by match to 1182R") +
theme_bw()
partition_1182C_SNPs <- Sub_1182C_SNPs %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(pos1182V = as.factor(ifelse(Position %in% Sub_1182V_SNPs$Position,"1182V_SNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
partition_1182C_SNPs <- Sub_1182C_SNPs %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(pos1182V = as.factor(ifelse(Position %in% Sub_1182V_SNPs$Position,"1182V_SNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182R") +
theme_bw()
View(partition_1182C_SNPs)
ggplot(partition_1182V_SNPs,aes(x=Position,fill = pos1182V)) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("Chromosome position of 1182C SNPs by match to 1182V") +
theme_bw()
ggplot(partition_1182C_SNPs,aes(x=Position,fill = pos1182V)) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("Chromosome position of 1182C SNPs by match to 1182V") +
theme_bw()
library(tidyverse)
library(ape)
library(stringr)
Gubbins_recombination_predictions <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Gubbins/CT_Gubbins_184_05_22_MASKED.recombination_predictions.gff", header=FALSE, comment.char="#") %>%
separate(V9,into=c("nodes","liklihood","taxa","snps"),sep=";") %>%
select(-V1,-V2,-V3,-V6,-V7,-V8,-liklihood) %>%
mutate(taxa = gsub("taxa=","",taxa)) %>%
mutate(taxa = trimws(taxa,which="both")) %>%
mutate(snps=as.numeric(gsub("snp_count=","",snps))) %>%
mutate(nodes=gsub("node=","",nodes))
final_tree <- read.tree("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Gubbins/CT_Gubbins_184_05_22_MASKED.node_labelled.final_tree.tre")
Fiji_tips <- final_tree$tip.label[grepl("\\dV|\\dR|\\dC",final_tree$tip.label)]
test_tips <- function(in_str,test_vec) {
in_vec <- unlist(strsplit(in_str,"\\s+"))
print(in_vec)
result <- in_vec %in% test_vec
print(result)
if (length(result) == sum(result)) {
return(TRUE)
} else {
return(FALSE)
}
}
tt_vector <- sapply(1:nrow(Gubbins_recombination_predictions), function(x) test_tips(Gubbins_recombination_predictions$taxa[x],Fiji_tips))
Gubbins_Fiji <- add_column(Gubbins_recombination_predictions,tt_vector) %>%
mutate(recomb_len = V5-V4) %>%
mutate(tt_vector = ifelse("TRUE","Fiji-tip","not-Fiji-tips"))
#Gubbins_Fiji %>% group_by(tt_vector) %>%
summarise(mean_len = mean(recomb_len))
Gubbins_Fiji %>% group_by(tt_vector) %>%
summarise(mean_len = mean(recomb_len))
kruskal.test(recomb_len ~ tt_vector, data = Gubbins_Fiji)
plot(final_tree)
Gubbins_stats <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Gubbins/CT_Gubbins_184_05_22_MASKED.per_branch_statistics.csv") %>%
mutate(group = case_when(grepl("\\dV|\\dR|\\dC",Node) ~ "Fiji",
grepl("internal",Node) ~ "Internal",
TRUE ~ "Reference"))
Gubbins_stats_tips <- Gubbins_stats %>%
filter(group %in% c("Fiji","Reference"))
kruskal.test(r.m ~ group, data = Gubbins_stats_tips)
kruskal.test(rho.theta ~ group, data = Gubbins_stats_tips)
Gubbins_stats_tips %>%
filter(group == "Fiji") %>%
ggplot(aes(x=Num.of.Recombination.Blocks)) +
geom_histogram(color="black", fill="white") +
stat_bin(binwidth=1,geom="text", aes(label=..count..) , vjust = -1)
Gubbins_stats_tips %>%
filter(group == "Fiji") %>%
filter(Num.of.Recombination.Blocks > 0)  %>%
arrange(Node)
Gubbins_Fiji %>%
filter(taxa == "1182V") %>%
mutate(chrom = "1182V") %>%
select(chrom, chromStart = V4,chromEnd = V5) %>%
write_delim(file="~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V.bed", delim = "\t")
tophits_1182V <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-recombinant_blast.out", header=FALSE) %>%
filter(V2 == "1182V") %>%
filter(V3 == 100) %>%
select(V2,V9,V10)
blast_1187V <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-recombinant_blast.out", header=FALSE) %>%
select(-V11,-V6) %>%
filter(V3 > 99) %>%
group_by(V1,V9) %>%
slice_max(V12) %>%
filter(V9 %in% tophits_1182V$V9) %>%
filter(V10 %in% tophits_1182V$V10) %>%
group_by(V2) %>%
summarise(matches = n()) %>%
arrange(desc(matches))
read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-recombinant_blast.out", header=FALSE) %>%
select(-V11,-V6) %>%
filter(V3 > 99) %>%
group_by(V1,V9) %>%
slice_max(V12) %>%
filter(V9 %in% tophits_1182V$V9) %>%
filter(V10 %in% tophits_1182V$V10) %>%
arrange(V9)
Gubbins_Fiji %>%
filter(taxa == "1182V") %>%
mutate(chrom == "1182V") %>%
select(chrom, chromStart = V4,chromEnd = V5) %>%
write_delim(file="~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V.bed", delim = "\t")
View(Sub_1182R_potential_minors)
View(Gubbins_Fiji)
View(Gubbins_stats_tips)
Gubbins_Fiji %>%
filter(taxa == "1182V")
Gubbins_Fiji %>%
filter(taxa == "1182V") %>%
select(chrom, chromStart = V4,chromEnd = V5)
recombination_ranges_1182V <- read_tsv("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V.bed")
bedfile_1182V.2 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-2.bed", header=FALSE)
View(bedfile_1182V.2)
bedfile_1182V.2 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-2.bed", header=FALSE)
table(partition_1182V_SNPs$pos1182R)
table(partition_1182C_SNPs$pos1182R)
table(partition_1182C_SNPs$pos1182R)
library(tidyverse)
library(Biostrings)
View(bedfile_1182V.2)
bedfile_1182V.2 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-2.bed", header=FALSE)
recomb_irange <- IRanges(start=bedfile_1182V.2$V2,end=bedfile_1182V.2$V3)
View(recomb_irange)
rrecomb_recomb_irange
recomb_irange
partition_1182C_SNPs %>%
filter(pos1182V == "other_SNP") %>%
select(Position) %>%
.$Posiiton
partition_1182C_SNPs %>%
filter(pos1182V == "other_SNP") %>%
select(Position)
partition_1182C_SNPs %>%
filter(pos1182V == "other_SNP") %>%
.$Position
bedfile_1182V.2 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-2.bed", header=FALSE)
recomb_irange <- IRanges(start=bedfile_1182V.2$V2,end=bedfile_1182V.2$V3)
other_SNPs_1182C <- partition_1182C_SNPs %>%
filter(pos1182V == "other_SNP") %>%
.$Position
shared_SNPs_1182C <- partition_1182C_SNPs %>%
filter(pos1182V == "1182V_SNP") %>%
.$Position
sub1182C_other_snps_irange <- IRanges(start= other_SNPs_1182C ,width=1)
sub1182C_shared_snps_irange <- IRanges(start= shared_SNPs_1182C ,width=1)
findOverlaps(recomb_irange,sub1182C_other_snps_irang)
sub1182C_other_snps_irange
findOverlaps(recomb_irange,sub1182C_other_snps_irange)
findOverlaps(recomb_irange,sub1182C_shared_snps_irange)
bedfile_1182V.2 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-2.bed", header=FALSE)
recomb_irange <- IRanges(start=bedfile_1182V.2$V2,end=bedfile_1182V.2$V3)
other_SNPs_1182C <- partition_1182C_SNPs %>%
filter(pos1182V == "other_SNP" & pos1182R == "other_SNP") %>%
.$Position
shared_SNPs_1182C <- partition_1182C_SNPs %>%
filter(pos1182V == "1182V_SNP" & pos1182R == "other_SNP") %>%
.$Position
sub1182C_other_snps_irange <- IRanges(start= other_SNPs_1182C ,width=1)
sub1182C_shared_snps_irange <- IRanges(start= shared_SNPs_1182C ,width=1)
findOverlaps(recomb_irange,sub1182C_other_snps_irange)
findOverlaps(recomb_irange,sub1182C_shared_snps_irange)
recomb_irange
View(Sub_1182V_SNPs)
other_SNPs_1182C
View(partition_1182V_SNPs)
View(Sub_1182V_SNPs)
View(Sub_1182V_potential_minors)
View(Sub_1182C_potential_minors)
View(Sub_1182C_SNPs)
View(Sub_1182R_potential_minors)
View(Sub_1182R_SNPs)
View(Sub_1182V_potential_minors)
View(Sub_1182V_SNPs)
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
add_row(Sub_1182C_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
table(partition_1182V_SNPs$pos1182R)
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
add_row(Sub_1182V_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
table(partition_1182V_SNPs$pos1182R)
ggplot(partition_1182V_SNPs,aes(x=SNP_percent,fill = pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency pf 1182V SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182V_SNPs,aes(x=Position,fill = pos1182R)) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("Chromosome position of 1182V SNPs by match to 1182R") +
theme_bw()
partition_1182C_SNPs <- Sub_1182C_SNPs %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(pos1182V = as.factor(ifelse(Position %in% partition_1182V_SNPs$Position,"1182V_SNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182C_SNPs,aes(x=Position,fill = pos1182V)) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("Chromosome position of 1182C SNPs by match to 1182V") +
theme_bw()
bedfile_1182V.2 <- read.delim("~/Documents/2021-Fiji-Ct_paper/Manuscript_Figures_data/Global_PhylogeneticTree/Snippy_alignment/1182V-2.bed", header=FALSE)
recomb_irange <- IRanges(start=bedfile_1182V.2$V2,end=bedfile_1182V.2$V3)
other_SNPs_1182C <- partition_1182C_SNPs %>%
filter(pos1182V == "other_SNP" & pos1182R == "other_SNP") %>%
.$Position
shared_SNPs_1182C <- partition_1182C_SNPs %>%
filter(pos1182V == "1182V_SNP" & pos1182R == "other_SNP") %>%
.$Position
sub1182C_other_snps_irange <- IRanges(start= other_SNPs_1182C ,width=1)
sub1182C_shared_snps_irange <- IRanges(start= shared_SNPs_1182C ,width=1)
findOverlaps(recomb_irange,sub1182C_other_snps_irange)
findOverlaps(recomb_irange,sub1182C_shared_snps_irange)
View(Sub_1182R_SNPs)
partition_1182C_SNPs <- Sub_1182C_SNPs %>%
add_row(Sub_1182C_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(pos1182V = as.factor(ifelse(Position %in% partition_1182V_SNPs$Position,"1182V_SNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182C_SNPs,aes(x=Position,fill = pos1182V)) +
geom_histogram(binwidth=20000, alpha=0.2, position="identity") +
ggtitle("Chromosome position of 1182C SNPs by match to 1182V") +
theme_bw()
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
add_row(Sub_1182V_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
mutate(Higgest_SNPs = as.factor(ifelse(SNP_percent > 99,1,0)))
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
add_row(Sub_1182V_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1)) %>%
mutate(Higgest_SNPs = as.factor(ifelse(SNP_percent > 99,1,0)))
table(partition_1182V_SNPs$pos1182R)
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
add_row(Sub_1182V_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1)) %>%
mutate(Highest_SNPs = as.factor(ifelse(SNP_percent > 99,1,0)))
table(partition_1182V_SNPs$pos1182R)
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = Highest_SNPs)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182V SNPs > 99%") +
theme_bw()
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
add_row(Sub_1182V_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1)) %>%
mutate(Highest_SNPs = as.factor(ifelse(SNP_percent > 99,1,0)))
table(partition_1182V_SNPs$pos1182R)
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
add_row(Sub_1182V_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1)) %>%
mutate(Highest_SNPs = as.factor(ifelse(SNP_percent > 99,1,0))) %>%
mutate(Medium_SNPs= as.factor(ifelse(SNP_percent < 99 &SNP_percent > 80,1,0)))
table(partition_1182V_SNPs$pos1182R)
Medium_1182V_SNPss <- partition_1182V_SNPs %>%
filter(Medium_SNPs == 1) %>%
.$Position
High_1182V_SNPss <- partition_1182V_SNPs %>%
filter(Highest_SNPs == 1) %>%
.$Position
partition_1182V_SNPs <- Sub_1182V_SNPs %>%
add_row(Sub_1182V_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1)) %>%
mutate(Highest_SNPs = as.factor(ifelse(SNP_percent < 2,1,0))) %>%
mutate(Medium_SNPs= as.factor(ifelse(SNP_percent > 2 & SNP_percent < 21,1,0)))
Medium_1182V_SNPss <- partition_1182V_SNPs %>%
filter(Medium_SNPs == 1) %>%
.$Position
High_1182V_SNPss <- partition_1182V_SNPs %>%
filter(Highest_SNPs == 1) %>%
.$Position
table(partition_1182V_SNPs$pos1182R)
partition_1182C_SNPs <- Sub_1182C_SNPs %>%
add_row(Sub_1182C_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(medium_pos1182V = as.factor(ifelse(Position %in% Medium_1182V_SNPss,"1182V_medium_SNP","not_1182V_medium_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = medium_pos1182V)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182V SNPs > 99%") +
theme_bw()
partition_1182C_SNPs <- Sub_1182C_SNPs %>%
add_row(Sub_1182C_potential_minors) %>%
mutate(pos1182R = as.factor(ifelse(Position %in% Sub_1182R_potential_minors$Position,"1182R_iSNP","other_SNP"))) %>%
mutate(medium_pos1182V = as.factor(ifelse(Position %in% Medium_1182V_SNPss,"1182V_medium_SNP","not_1182V_medium_SNP"))) %>%
mutate(high_pos1182V = as.factor(ifelse(Position %in% High_1182V_SNPss,"1182V_high_SNP","not_1182V_high_SNP"))) %>%
mutate(SNP_percent = round(Ref_cov/(Ref_cov + Aa + Gg + Cc + Tt)*100,digits=1))
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = pos1182R)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182R") +
theme_bw()
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = medium_pos1182V)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182V SNPs > 2-20%") +
theme_bw()
ggplot(partition_1182C_SNPs,aes(x=SNP_percent,fill = high_pos1182V)) +
geom_histogram(binwidth=1, alpha=0.2, position="identity") +
ggtitle("Frequency of 1182C SNPs by match to 1182V SNPs < 2%") +
theme_bw()
