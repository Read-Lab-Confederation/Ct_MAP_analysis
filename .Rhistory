geom_point()+
theme_bw() +
ggtitle("Numbers of intermediate SNPs versus sample depth of coverage")
RI_SNPs <- res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(RI_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of rare intermediate SNPs versus sample depth of coverage")
RI_SNPs %>% filter(Mean.depth.of.coverage > 1000) %>%
filter(SNPs > 0)
F_SNPs <- res_table %>%
select(subject_name,RonlyF,ConlyF,VonlyF) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyF" ~ paste0(subject_name,"R"),
site == "ConlyF" ~ paste0(subject_name,"C"),
site == "VonlyF" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(F_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of fixed SNPs versus sample depth of coverage")
View(F_SNPs)
View(res_table)
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv")
View(Supplemental_Table_3)
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv") %>%
select(1..5)
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv") %>%
select(c(1..5))
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv") %>%
select(c(1:5))
View(Supplemental_Table_3)
View(res_table)
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-08.tsv") %>%
select(c(1:5))
Supp_Table_3_res <- inner_join(Supplemental_Table_3,res_table, by = c("Participant"="subject_name"))
View(Supp_Table_3_res)
gpA_rectal_fixed <- Supplemental_Table_3 %>%
filter(Group == "A" | RonlyF > 0)
gpA_rectal_fixed <- Supplemental_Table_3 %>%
filter(Group == "A")
gpA_rectal_fixed <- Supplemental_Table_3 %>%
filter(Group == "A") %>%
filter(RonlyF > 0)
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0)
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0)
View(gpA_rectal_fixed)
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_vaginal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(VonlyF > 0) %>%
nrow()
gpA_endocervical_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(ConlyF > 0) %>%
nrow()
Pos_count %>%
filter(n < 4) %>%
tally()
View(res_table)
res_files <- list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
res_table <- read.delim(res_files[1])
res_files[1]
res_files <- list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
gpA_R_fixed_rareC <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF_CIrare > 0 | RonlyF_CandVIrare > 0) %>%
nrow()
venn_tab2 <- Supp_Table_3_res %>%
filter(Group == "A") %>%
select(Participant,RonlyFrare,ConlyFrare,VonlyFrare,RConlyFrare,VConlyFrare,RVonlyFrare,RonlyF_VIrare,RonlyF_CIrare,ConlyF_RIrare,ConlyF_VIrare,VonlyF_RIrare,VonlyF_CIrare) %>%
mutate(RonlyFrare = ifelse(RonlyFrare > 0,paste0(Participant,"R",RonlyFrare),"")) %>%
mutate(VonlyFrare = ifelse(VonlyFrare > 0,paste0(Participant,"V",VonlyFrare),"")) %>%
mutate(ConlyFrare = ifelse(ConlyFrare > 0,paste0(Participant,"C",ConlyFrare),"")) %>%
mutate(RConlyFrare = ifelse(RConlyFrare > 0,paste0(Participant,"RC",RConlyFrare),"")) %>%
mutate(VConlyFrare = ifelse(VConlyFrare > 0,paste0(Participant,"VC",VConlyFrare),"")) %>%
mutate(RVonlyFrare = ifelse(RVonlyFrare > 0,paste0(Participant,"RV",RVonlyFrare),"")) %>%
mutate(RonlyF_VIrare = ifelse(RonlyF_VIrare > 0,paste0(Participant,"RVI",RonlyF_VIrare),"")) %>%
mutate(RonlyF_CIrare = ifelse(RonlyF_CIrare > 0,paste0(Participant,"RCI",RonlyF_CIrare),"")) %>%
mutate(ConlyF_VIrare = ifelse(ConlyF_VIrare > 0,paste0(Participant,"CVI",ConlyF_VIrare),"")) %>%
mutate(ConlyF_RIrare = ifelse(ConlyF_RIrare > 0,paste0(Participant,"CRI",ConlyF_RIrare),"")) %>%
mutate(VonlyF_CIrare = ifelse(VonlyF_CIrare > 0,paste0(Participant,"VCI",VonlyF_CIrare),"")) %>%
mutate(VonlyF_RIrare = ifelse(VonlyF_RIrare > 0,paste0(Participant,"VRI",VonlyF_RIrare),""))
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_pipeline(subject_id = 26)
SNP_analysis_pipeline(subject_id = 32)
SNP_analysis_pipeline(subject_id = 68)
SNP_analysis_pipeline(subject_id = 72)
SNP_analysis_pipeline(subject_id = 87)
SNP_analysis_pipeline(subject_id = 98)
SNP_analysis_pipeline(subject_id = 107)
SNP_analysis_pipeline(subject_id = 192)
SNP_analysis_pipeline(subject_id = 227)
SNP_analysis_pipeline(subject_id = 362)
SNP_analysis_pipeline(subject_id = 519)
SNP_analysis_pipeline(subject_id = 564)
SNP_analysis_pipeline(subject_id = 753)
SNP_analysis_pipeline(subject_id = 908)
SNP_analysis_pipeline(subject_id = 927)
SNP_analysis_pipeline(subject_id = 951)
SNP_analysis_pipeline(subject_id = 968)
SNP_analysis_pipeline(subject_id = 1077)
SNP_analysis_pipeline(subject_id = 1078)
SNP_analysis_pipeline(subject_id = 1079)
SNP_analysis_pipeline(subject_id = 1106)
SNP_analysis_pipeline(subject_id = 1145)
SNP_analysis_pipeline(subject_id = 1176)
SNP_analysis_pipeline(subject_id = 1182)
SNP_analysis_pipeline(subject_id = 1201)
SNP_analysis_pipeline(subject_id = 1226)
res_files <- list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
write_tsv(res_table,"./iSNP_analysis_table/all_results_table.tsv")
grand_summary <- read.delim("./2021_08_24-Grand_Summary - MAP_analysis_summary.tsv")
list_of_87 <- read.delim("list_87_strains.txt", header = F)
mean_doc <- grand_summary %>%
mutate(Sample = sub("-WGS","",Sample)) %>%
mutate(Sample = sub("Rs","R",Sample)) %>%
mutate(Sample = sub("Vs","V",Sample)) %>%
filter(Sample %in% list_of_87$V1) %>%
select(Sample,Subject,Body.Site,Mean.depth.of.coverage,intermediate_SNPs)
#Figure W3
ggplot(mean_doc,aes(x=Body.Site,y=Mean.depth.of.coverage)) +
geom_boxplot() +
theme_bw()
ggplot(mean_doc,aes(x=Mean.depth.of.coverage,y=intermediate_SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of intermediate SNPs versus sample depth of coverage")
RI_SNPs <- res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(RI_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of rare intermediate SNPs versus sample depth of coverage")
RI_SNPs %>% filter(Mean.depth.of.coverage > 1000) %>%
filter(SNPs > 0)
F_SNPs <- res_table %>%
select(subject_name,RonlyF,ConlyF,VonlyF) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyF" ~ paste0(subject_name,"R"),
site == "ConlyF" ~ paste0(subject_name,"C"),
site == "VonlyF" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(F_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of fixed SNPs versus sample depth of coverage")
Supplemental_Table_3 <- read.delim("~/GitHub/Ct_MAP_analysis/Supplemental_Table_3-2022-06-12.tsv") %>%
select(c(1:5))
Supp_Table_3_res <- inner_join(Supplemental_Table_3,res_table, by = c("Participant"="subject_name"))
write_tsv(Supp_Table_3_res, file = "new_supplementary_table3.tsv")
venn_tab1 <- Supp_Table_3_res %>%
filter(Group == "A") %>%
select(Participant,RonlyFrare,ConlyFrare,VonlyFrare,RConlyFrare,VConlyFrare,RVonlyFrare) %>%
mutate(RonlyFrare = ifelse(RonlyFrare > 0,paste0(Participant,"R",RonlyFrare),"")) %>%
mutate(VonlyFrare = ifelse(VonlyFrare > 0,paste0(Participant,"V",VonlyFrare),"")) %>%
mutate(ConlyFrare = ifelse(ConlyFrare > 0,paste0(Participant,"C",ConlyFrare),"")) %>%
mutate(RConlyFrare = ifelse(RConlyFrare > 0,paste0(Participant,"RC",RConlyFrare),"")) %>%
mutate(VConlyFrare = ifelse(VConlyFrare > 0,paste0(Participant,"VC",VConlyFrare),"")) %>%
mutate(RVonlyFrare = ifelse(RVonlyFrare > 0,paste0(Participant,"RV",RVonlyFrare),""))
fixed_mutations <- as.vector(as.matrix(venn_tab1[,c("RonlyFrare","ConlyFrare","VonlyFrare","RConlyFrare","VConlyFrare","RVonlyFrare")]))
fixed_mutations <- fixed_mutations[fixed_mutations != ""]
C_strains <- c(str_which(fixed_mutations,"C"),venn_tab1$Participant)
R_strains <- c(str_which(fixed_mutations,"R"),venn_tab1$Participant)
V_strains <- c(str_which(fixed_mutations,"V"),venn_tab1$Participant)
library(VennDiagram)
library(RColorBrewer)
myCol <- brewer.pal(3,"Accent")
venn.diagram(
x = list(C_strains, R_strains, V_strains),
category.names = c("Endocervix" , "Rectum " , "Vagina"),
filename = 'VennFig1.png',
output=TRUE,
# Output features
imagetype="png" ,
height = 480 ,
width = 480 ,
resolution = 300,
compression = "lzw",
# Circles
lwd = 2,
lty = 'blank',
fill = myCol,
# Numbers
cex = .6,
fontface = "bold",
fontfamily = "sans",
# Set names
cat.cex = 0.6,
cat.fontface = "bold",
cat.default.pos = "outer",
cat.pos = c(-27, 27, 135),
cat.dist = c(0.055, 0.055, 0.085),
cat.fontfamily = "sans",
rotation = 1
)
venn_tab2 <- Supp_Table_3_res %>%
filter(Group == "A") %>%
select(Participant,RonlyFrare,ConlyFrare,VonlyFrare,RConlyFrare,VConlyFrare,RVonlyFrare,RonlyF_VIrare,RonlyF_CIrare,ConlyF_RIrare,ConlyF_VIrare,VonlyF_RIrare,VonlyF_CIrare) %>%
mutate(RonlyFrare = ifelse(RonlyFrare > 0,paste0(Participant,"R",RonlyFrare),"")) %>%
mutate(VonlyFrare = ifelse(VonlyFrare > 0,paste0(Participant,"V",VonlyFrare),"")) %>%
mutate(ConlyFrare = ifelse(ConlyFrare > 0,paste0(Participant,"C",ConlyFrare),"")) %>%
mutate(RConlyFrare = ifelse(RConlyFrare > 0,paste0(Participant,"RC",RConlyFrare),"")) %>%
mutate(VConlyFrare = ifelse(VConlyFrare > 0,paste0(Participant,"VC",VConlyFrare),"")) %>%
mutate(RVonlyFrare = ifelse(RVonlyFrare > 0,paste0(Participant,"RV",RVonlyFrare),"")) %>%
mutate(RonlyF_VIrare = ifelse(RonlyF_VIrare > 0,paste0(Participant,"RVI",RonlyF_VIrare),"")) %>%
mutate(RonlyF_CIrare = ifelse(RonlyF_CIrare > 0,paste0(Participant,"RCI",RonlyF_CIrare),"")) %>%
mutate(ConlyF_VIrare = ifelse(ConlyF_VIrare > 0,paste0(Participant,"CVI",ConlyF_VIrare),"")) %>%
mutate(ConlyF_RIrare = ifelse(ConlyF_RIrare > 0,paste0(Participant,"CRI",ConlyF_RIrare),"")) %>%
mutate(VonlyF_CIrare = ifelse(VonlyF_CIrare > 0,paste0(Participant,"VCI",VonlyF_CIrare),"")) %>%
mutate(VonlyF_RIrare = ifelse(VonlyF_RIrare > 0,paste0(Participant,"VRI",VonlyF_RIrare),""))
fixed_mutations2 <- as.vector(as.matrix(venn_tab2[,c("RonlyFrare","ConlyFrare","VonlyFrare","RConlyFrare","VConlyFrare","RVonlyFrare","RonlyF_VIrare","RonlyF_CIrare","ConlyF_RIrare","ConlyF_VIrare","VonlyF_RIrare","VonlyF_CIrare")]))
fixed_mutations2 <- fixed_mutations2[fixed_mutations2 != ""]
C_strains2 <- c(str_which(fixed_mutations2,"C"),venn_tab2$Participant)
R_strains2 <- c(str_which(fixed_mutations2,"R"),venn_tab2$Participant)
V_strains2 <- c(str_which(fixed_mutations2,"V"),venn_tab2$Participant)
library(VennDiagram)
library(RColorBrewer)
myCol <- brewer.pal(3,"Accent")
venn.diagram(
x = list(C_strains2, R_strains2, V_strains2),
category.names = c("Endocervix" , "Rectum " , "Vagina"),
filename = 'VennFig2.png',
output=TRUE,
# Output features
imagetype="png" ,
height = 480 ,
width = 480 ,
resolution = 300,
compression = "lzw",
# Circles
lwd = 2,
lty = 'blank',
fill = myCol,
# Numbers
cex = .4,
fontface = "bold",
fontfamily = "sans",
# Set names
cat.cex = 0.4,
cat.fontface = "bold",
cat.default.pos = "text",
cat.pos = c(-27, 27, 135),
cat.dist = c(0.055, 0.055, 0.085),
cat.fontfamily = "sans",
rotation = 1
)
gpA_rectal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF > 0) %>%
nrow()
gpA_vaginal_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(VonlyF > 0) %>%
nrow()
gpA_endocervical_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(ConlyF > 0) %>%
nrow()
gpA_RC_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RConlyF > 0) %>%
nrow()
gpA_RV_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RVonlyF > 0) %>%
nrow()
gpA_VC_fixed <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(VConlyF > 0) %>%
nrow()
gpA_RC_rareI <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RConlyRIrare > 0) %>%
nrow()
gpA_RV_rareI <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RVonlyRIrare > 0) %>%
nrow()
gpA_VC_rareI <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(VConlyRIrare > 0) %>%
nrow()
gpA_R_fixed_rareC <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF_CIrare > 0 | RonlyF_CandVIrare > 0) %>%
nrow()
gpA_R_fixed_rareV <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(RonlyF_VIrare > 0 | RonlyF_CandVIrare > 0) %>%
nrow()
gpA_C_fixed_rareR <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(ConlyF_RIrare > 0 | ConlyF_RandVIrare > 0) %>%
nrow()
gpA_C_fixed_rareV <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(ConlyF_VIrare > 0 | ConlyF_RandVIrare > 0) %>%
nrow()
gpA_V_fixed_rareR <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(VonlyF_RIrare > 0 | VonlyF_CandRIrare > 0) %>%
nrow()
gpA_V_fixed_rareC <- Supp_Table_3_res %>%
filter(Group == "A") %>%
filter(VonlyF_CIrare > 0 | VonlyF_CandRIrare > 0) %>%
nrow()
myCol
View(venn_tab2)
View(Supp_Table_3_res)
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 1201)
library(tidyverse)
source("MAP_functions.R")
subject_id <- 1201
library(tidyverse)
source("MAP_functions.R")
library(assertthat)
in_file_name <- paste0("./iSNPs_by_subject/iSNPs_subject_",subject_id,".tsv")
Total_iSNPs <- read.delim(in_file_name)
assert_that(nrow(Total_iSNPs) > 0)
print(paste("Number of iSNP positions = ",nrow(Total_iSNPs)))
library(cowplot)
RCplot <- ggplot(filter(Total_iSNPs,!(R_percent > 90 & C_percent > 90)), aes(x=R_percent, y=C_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
RVplot <- ggplot(filter(Total_iSNPs,!(R_percent > 90 & V_percent > 90)), aes(x=R_percent, y=V_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
VCplot <- ggplot(filter(Total_iSNPs,!(V_percent > 90 & C_percent > 90)), aes(x=V_percent, y=C_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
try1_title <- ggdraw() +
theme(plot.margin = margin(0, 0, 0, 7))
tryptich1 <- plot_grid(
RCplot, RVplot, VCplot,
labels = c("e","f","g")
)
tryptich1
T1T2_denovo_snps <- read_lines("T1T2_snps_denovo.list")
R_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"R_MAP.txt"),"R") %>%
#filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent,regular)
assert_that(nrow(R_MAP) > 0)
R_bases <- nrow(R_MAP)
print(paste("Numbers of R bases above cutoff is ",R_bases))
C_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"C_MAP.txt"),"C") %>%
#filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent,regular)
assert_that(nrow(C_MAP) > 0)
C_bases <- nrow(C_MAP)
print(paste("Numbers of C bases above cutoff is ",C_bases))
V_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"V_MAP.txt"),"V") %>%
#filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent,regular)
T1T2_denovo_df <- full_join(R_MAP,V_MAP, by = "Position") %>%
full_join(.,C_MAP, by = "Position") %>%
filter(Position %in% T1T2_denovo_snps)
colnames(T1T2_denovo_df) <- c("Position","Rectum","Vagina","Endocervix")
View(T1T2_denovo_df)
T1T2_denovo_df <- full_join(R_MAP,V_MAP, by = "Position") %>%
full_join(.,C_MAP, by = "Position") %>%
filter(Position %in% T1T2_denovo_snps)
R_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"R_MAP.txt"),"R") %>%
#filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent)
assert_that(nrow(R_MAP) > 0)
R_bases <- nrow(R_MAP)
print(paste("Numbers of R bases above cutoff is ",R_bases))
C_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"C_MAP.txt"),"C") %>%
#filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent)
assert_that(nrow(C_MAP) > 0)
C_bases <- nrow(C_MAP)
print(paste("Numbers of C bases above cutoff is ",C_bases))
V_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"V_MAP.txt"),"V") %>%
#filter(regular > -1 & regular < 1) %>%
filter(Coverage > cov_cutoff) %>%
select(Position,SNP_percent)
assert_that(nrow(V_MAP) > 0)
T1T2_denovo_df <- full_join(R_MAP,V_MAP, by = "Position") %>%
full_join(.,C_MAP, by = "Position") %>%
filter(Position %in% T1T2_denovo_snps)
colnames(T1T2_denovo_df) <- c("Position","Rectum","Vagina","Endocervix")
T1T2_denovo_df_long <- gather(T1T2_denovo_df,"Body_site","SNP_percent",-Position)
View(T1T2_denovo_df_long)
library(RColorBrewer)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[1]) +
xlim(1,1042504)+
ylab("% ref") +
theme_bw() +
theme(axis.text = element_text(size=9))
snps_ref2 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[2]) +
xlim(1,1042504)+
labs(y = "% ref") +
theme_bw() +
theme(axis.text = element_text(size=9))
snps_ref3 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[3]) +
xlim(1,1042504)+
labs(y = "% ref") +
theme_bw()+
theme(axis.text = element_text(size=9))
snps_ref2 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[2]) +
xlim(1,1042504)+
labs(y = "% ref") +
theme_bw() +
theme(axis.text = element_text(size=9))
snps_ref3 <- ggplot(filter(T1T2_denovo_df_long,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = 0.5) +
scale_color_manual(values = cust_pal[3]) +
xlim(1,1042504)+
labs(y = "% ref") +
theme_bw()+
theme(axis.text = element_text(size=9))
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
snps_ref4
snps_ref4 + coord_flip()
CSNP_plot2 <- plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v',labels = c('a', 'b','c'),label_y = 0.95)
CSNP_plot3 <- plot_grid(snps_ref4 + coord_flip(), ncol = 1, align = 'v',labels = c('d'),label_y = 0.98,label_x = 0.015)
CSNP_plot3
plot_filename = paste0(subject_id,"_combined.jpg")
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
SNP_analysis_for_pub(subject_id = 1201)
SNP_analysis_for_pub(subject_id = 32)
SNP_analysis_for_pub(subject_id = 1201)
SNP_analysis_for_pub(subject_id = 1176)
SNP_analysis_for_pub(subject_id = 564)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_for_pub(subject_id = 1201)
SNP_analysis_for_pub(subject_id = 32)
SNP_analysis_for_pub(subject_id = 1176)
SNP_analysis_for_pub(subject_id = 564)
SNP_analysis_for_pub(subject_id = 1078)
