print(paste("C is fixed, R only is intermediate, and rare (ConlyF_RIrare) = ",ConlyF_RIrare))
print(paste("C is fixed, R and V are intermediate, and rare (ConlyF_RandVIrare) = ",ConlyF_RandVIrare))
print(paste("V is fixed, C only is intermediate, and rare (VonlyF_CIrare) = ",VonlyF_CIrare))
print(paste("V is fixed, R only is intermediate, and rare (VonlyF_RIrare) = ",VonlyF_RIrare))
print(paste("V is fixed, R and C are intermediate, and rare (VonlyF_CandRIrare) = ",VonlyF_CandRIrare))
ggparcoord(data = Total_iSNPs,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2)
T1T2_denovo_snps <- read_lines("../T1T2_snps_denovo_v2.list")
T1T2_denovo_df <- full_join(R_MAP,V_MAP, by = "Position") %>%
full_join(.,C_MAP, by = "Position") %>%
filter(Position %in% T1T2_denovo_snps)
colnames(T1T2_denovo_df) <- c("Position","Rectum","Vagina","Endocervix")
T1T2_denovo_df_long <- gather(T1T2_denovo_df,"Body_site","SNP_percent",-Position)
ggparcoord(data = T1T2_denovo_df,
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2,
title = paste0("cDenovo_SNPs for" ,subject_id))
test_snpplot <- function(test_df,x1=1,x2=1042504,sz = 0.5) {
library(RColorBrewer)
library(cowplot)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(test_df,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[1]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(test_df,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[2]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(test_df,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[3]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
ggtitle(paste0("cDenovo reference SNPs for ",subject_id)) +
theme_bw() +
theme(axis.text.y = element_blank())
plot_grid(snps_ref1,snps_ref2,snps_ref3,snps_ref4, ncol = 1, align = 'v')
}
test_snpplot(T1T2_denovo_df_long)
print(paste("Number cDenovo Ref SNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix > 90))))
print(paste("Number cDenovo Non-Ref SNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix < 10))))
print(paste("Number cDenovo iSNPs for C = ",nrow(filter(T1T2_denovo_df,Endocervix >= 10 & Endocervix <= 90))))
print(paste("Number cDenovo Ref SNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum > 90))))
print(paste("Number cDenovo Non-Ref SNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum < 10))))
print(paste("Number cDenovo iSNPs for R = ",nrow(filter(T1T2_denovo_df,Rectum >= 10 & Rectum <= 90))))
print(paste("Number cDenovo Ref SNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina > 90))))
print(paste("Number cDenovo Non-Ref SNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina < 10))))
print(paste("Number cDenovo iSNPs for V = ",nrow(filter(T1T2_denovo_df,Vagina >= 10 & Vagina <= 90))))
all_SNPs <-
inner_join(R_MAP,V_MAP, by = "Position") %>%
inner_join(.,C_MAP, by = "Position")
colnames(all_SNPs) <- c("Position","Rectum","Vagina","Endocervix")
plotGub <- function(Gubstart,Gubend,subject_id,test_df) {
test_df %>%
filter((Position >= Gubstart & Position <=  Gubend)) %>%
ggparcoord(
columns = 2:4,
scale = "globalminmax",
alphaLines = 0.2,
title = paste("Subject",subject_id,"coords",Gubstart,"to",Gubend))
}
plotGub(54281,58402,1201,all_SNPs)
test_snpplot(T1T2_denovo_df_long,54298,58561,sz=1)
nrow(filter(R_MAP,Position >= 54298	& Position <= 58561))
nrow(filter(C_MAP,Position >= 54298	& Position <= 58561))
nrow(filter(V_MAP,Position >= 54298	& Position <= 58561))
test_snpplot <- function(test_df,x1=1,x2=1042504,sz = 0.5,swi = 1) {
library(RColorBrewer)
library(cowplot)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(test_df,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[1]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(test_df,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[2]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(test_df,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[3]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
if (sw == 1) {
plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v')
} else {
plot_grid(snps_ref4, ncol = 1, align = 'v')
}
}
test_snpplot <- function(test_df,x1=1,x2=1042504,sz = 0.5,swi = 1) {
library(RColorBrewer)
library(cowplot)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(test_df,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[1]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(test_df,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[2]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(test_df,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[3]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
if (swi == 1) {
plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v')
} else {
plot_grid(snps_ref4, ncol = 1, align = 'v')
}
}
test_snpplot(T1T2_denovo_df_long,swi= 1)
test_snpplot(T1T2_denovo_df_long,swi= 0)
test_snpplot(T1T2_denovo_df_long,54298,58561,sz=1,swi = 0)
test_snpplot <- function(test_df,x1=1,x2=1042504,sz = 0.5,swi = 1) {
library(RColorBrewer)
library(cowplot)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(test_df,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[1]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(test_df,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[2]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(test_df,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[3]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
if (swi == 1) {
plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v',labels = c('d', 'e','f'))
} else {
plot_grid(snps_ref4, ncol = 1, align = 'v',labels = c('g'))
}
}
test_snpplot(T1T2_denovo_df_long,swi= 1)
test_snpplot(T1T2_denovo_df_long,swi= 0)
test_snpplot <- function(test_df,x1=1,x2=1042504,sz = 0.5,swi = 1) {
library(RColorBrewer)
library(cowplot)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(test_df,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[1]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(test_df,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[2]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(test_df,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[3]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
if (swi == 1) {
plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v',labels = c('d', 'e','f'),vjust = 0.5)
} else {
plot_grid(snps_ref4, ncol = 1, align = 'v',labels = c('g'),vjust = 0.5)
}
}
test_snpplot(T1T2_denovo_df_long,swi= 1)
test_snpplot <- function(test_df,x1=1,x2=1042504,sz = 0.5,swi = 1) {
library(RColorBrewer)
library(cowplot)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(test_df,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[1]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(test_df,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[2]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(test_df,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[3]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
if (swi == 1) {
plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v',labels = c('d', 'e','f'),vjust = 0.3)
} else {
plot_grid(snps_ref4, ncol = 1, align = 'v',labels = c('g'),vjust = 0.3)
}
}
test_snpplot(T1T2_denovo_df_long,swi= 1)
test_snpplot <- function(test_df,x1=1,x2=1042504,sz = 0.5,swi = 1) {
library(RColorBrewer)
library(cowplot)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(test_df,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[1]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(test_df,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[2]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(test_df,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[3]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
if (swi == 1) {
plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v',labels = c('d', 'e','f'),vjust = 0.2)
} else {
plot_grid(snps_ref4, ncol = 1, align = 'v',labels = c('g'),vjust = 0.2)
}
}
test_snpplot(T1T2_denovo_df_long,swi= 1)
test_snpplot(T1T2_denovo_df_long,swi= 0)
test_snpplot <- function(test_df,x1=1,x2=1042504,sz = 0.5,swi = 1) {
library(RColorBrewer)
library(cowplot)
cust_pal <- brewer.pal(3,"Accent")
snps_ref1 <- ggplot(filter(test_df,Body_site == "Endocervix"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[1]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref2 <- ggplot(filter(test_df,Body_site == "Rectum"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[2]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref3 <- ggplot(filter(test_df,Body_site == "Vagina"), aes(x= Position, y= SNP_percent, color = Body_site)) +
geom_point(alpha = 0.7, size = sz) +
scale_color_manual(values = cust_pal[3]) +
xlim(x1,x2)+
ylab("% reference") +
theme_bw()
snps_ref4 <- ggplot(T1T2_denovo_df_long, aes(x=SNP_percent,color = Body_site)) +
geom_boxplot() +
scale_color_brewer(palette = "Accent") +
xlab("Percent_cDenovo_reference") +
theme_bw() +
theme(axis.text.y = element_blank())
if (swi == 1) {
plot_grid(snps_ref1,snps_ref2,snps_ref3, ncol = 1, align = 'v',labels = c('d', 'e','f'),vjust = 0.1)
} else {
plot_grid(snps_ref4, ncol = 1, align = 'v',labels = c('g'),vjust = 0.2,hjust = 0.2)
}
}
test_snpplot(T1T2_denovo_df_long,swi= 1)
test_snpplot(T1T2_denovo_df_long,swi= 0)
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
source("~/GitHub/Ct_MAP_analysis/MAP_functions.R")
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_pipeline(subject_id = 26)
library(tidyverse)
source("MAP_functions.R")
SNP_analysis_pipeline(subject_id = 26)
SNP_analysis_pipeline(subject_id = 32)
SNP_analysis_pipeline(subject_id = 68)
SNP_analysis_pipeline(subject_id = 72)
SNP_analysis_pipeline(subject_id = 87)
SNP_analysis_pipeline(subject_id = 98)
SNP_analysis_pipeline(subject_id = 107)
SNP_analysis_pipeline(subject_id = 192)
SNP_analysis_pipeline(subject_id = 227)
SNP_analysis_pipeline(subject_id = 362)
SNP_analysis_pipeline(subject_id = 519)
SNP_analysis_pipeline(subject_id = 564)
SNP_analysis_pipeline(subject_id = 753)
SNP_analysis_pipeline(subject_id = 908)
SNP_analysis_pipeline(subject_id = 927)
SNP_analysis_pipeline(subject_id = 951)
SNP_analysis_pipeline(subject_id = 968)
SNP_analysis_pipeline(subject_id = 1077)
SNP_analysis_pipeline(subject_id = 1078)
SNP_analysis_pipeline(subject_id = 1079)
SNP_analysis_pipeline(subject_id = 1106)
SNP_analysis_pipeline(subject_id = 1145)
SNP_analysis_pipeline(subject_id = 1176)
SNP_analysis_pipeline(subject_id = 1182)
SNP_analysis_pipeline(subject_id = 1201)
SNP_analysis_pipeline(subject_id = 1226)
install.packages("~/Downloads/seedy_1.3.tar", repos = NULL)
plot(10:0,10:0)
plot(10:0 * 10:0)
library(tidyverse)
instr_files <- list.files("~/Documents/2021-Fiji-Ct_paper/inStrain_results/scaffold_info_results",full.names = T, pattern = "*profile_scaffold_info.tsv")
instr_files <- list.files("~/Documents/2021-Fiji-Ct_paper/inStrain_results/scaffold_info_results/",full.names = T, pattern = "*profile_scaffold_info.tsv")
instr_files <- list.files("/Users/timothyread/Documents/2021-Fiji-Ct_paper/inStrain_results/scaffold_info_results/",full.names = T, pattern = "*profile_scaffold_info.tsv")
instr_files <- list.files("/Users/timothyread/Documents/2021-Fiji-Ct_paper/inStrain_results/scaffold_info_results/",full.names = T, pattern = "*")
instr_files <- list.files("/Users/timothyread/Documents/2021-Fiji-Ct_paper/inStrain_results/scaffold_info_results",full.names = T, pattern = "*")
instr_files <- list.files("/Users/timothyread/Documents/2021-Fiji-Ct_paper/inStrain_results/scaffold_info_results",full.names = T)
instr_files <- list.files("/Users/timothyread/Documents/2021-Fiji-Ct_paper/inStrain_results/scaffold_info_results",full.names = F)
?list.files
instr_files <- list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/inStrain_results/scaffold_info_results",full.names = T)
instr_files <- list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/inStrain_results/",full.names = T)
instr_files <- list.files(path = "/Users/timothyread/Documents/2021-Fiji-Ct_paper/",full.names = T)
instr_files <- list.files(path = "/Users/timothyread/Documents/",full.names = T)
instr_files <- list.files(path = "/Users/timothyread/",full.names = T)
instr_files <- list.files(path = "/Users/timothyread/Documents/",full.names = T)
instr_files <- list.files(path = "./scaffold_info_results/",full.names = T)
instr_files <- list.files(path = "./scaffold_info_results/",full.names = T, pattern = "*.tsv")
instr_files[1]
instr_files[2]
instr_files <- list.files(path = "./scaffold_info_results/",full.names = T, pattern = "*.tsv")
instr_files <- list.files(path = "./scaffold_info_results/",full.names = T, pattern = "*.tsv")
instr_files[1]
instr_files <- list.files(path = "./scaffold_info_results",full.names = T, pattern = "*.tsv")
instr_files[1]
sub("[_|-]*","",instr_files[1])
instr_files <- list.files(path = "./scaffold_info_results",full.names = T, pattern = "*.tsv")
instr_names <- list.files(path = "./scaffold_info_results",full.names = F, pattern = "*.tsv")
sub("[_|-]*","",instr_names[1])
sub("_|-*","",instr_names[1])
sub("_*","",instr_names[1])
sub("_","",instr_names[1])
sub("_|-","",instr_names[1])
sub("_|-.*","",instr_names[1])
sub("(_|-).+","",instr_names[1])
instr_files <- list.files(path = "./scaffold_info_results",full.names = T, pattern = "*.tsv")
instr_names <- sub("(_|-).+","",list.files(path = "./scaffold_info_results",full.names = F, pattern = "*.tsv"))
instr_names
i = 1
temp.df <- read.delim(instr_files[i])
View(temp.df)
instr_files <- list.files(path = "./scaffold_info_results",full.names = T, pattern = "*.tsv")
sample <- sub("(_|-).+","",list.files(path = "./scaffold_info_results",full.names = F, pattern = "*.tsv"))
rm(instr_names)
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[1])
?add_column
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" )
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i)
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" )
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
for (i in 2:length(instr_files)){
temp2.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
res_table <- bind_rows(temp.df,temp2.df)
}
rm(res_table)
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
for (i in 2:length(instr_files)){
temp2.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
temp.df <- bind_rows(temp.df,temp2.df)
}
View(temp.df)
View(temp2.df)
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
for (i in 2:length(instr_files)){
temp2.df <- read.delim(instr_files[i])
add_column(temp2.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
temp.df <- bind_rows(temp.df,temp2.df)
}
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" )
rm(temp2.df)
i = 1
temp.df <- read.delim(instr_files[i])
add_column(temp.df,sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
i = 1
temp.df <- read.delim(instr_files[i]) %>%
add_column(sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
for (i in 2:length(instr_files)){
temp2.df <- read.delim(instr_files[i]) %>%
add_column(sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
temp.df <- bind_rows(temp.df,temp2.df)
}
library(tidyverse)
instr_files <- list.files(path = "./scaffold_info_results",full.names = T, pattern = "*.tsv")
sample <- sub("(_|-).+","",list.files(path = "./scaffold_info_results",full.names = F, pattern = "*.tsv"))
i = 1
temp.df <- read.delim(instr_files[i]) %>%
add_column(sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
for (i in 2:length(instr_files)){
temp2.df <- read.delim(instr_files[i]) %>%
add_column(sample[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample.i.)
temp.df <- bind_rows(temp.df,temp2.df)
}
genomes_files <- list.files(path = "./genome_info_results",full.names = T, pattern = "*.tsv")
sample_g <- sub("(_|-).+","",list.files(path = "./scaffold_info_results",full.names = F, pattern = "*.tsv"))
i = 1
gen.df <- read.delim(genomes_files[i]) %>%
add_column(sample_g[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample_g.i.)
View(gen.df)
for (i in 2:length(genomes_files)){
gen2.df <- read.delim(genomes_files[i]) %>%
add_column(sample_g[i], .before = 1, .name_repair = "universal" ) %>%
rename(sample = sample_g.i.)
gen.df <- bind_rows(gen.df,gen2.df)
}
library(tidyverse)
recombinations_ancestral <- read.csv("~/Documents/2021-Fiji-Ct_paper/fastGEAR_withGlobal_189/recombinations_ancestral.txt", sep="") %>%
mutate(Length = End-Start+1)
recombinations_ancestral %>%
filter(Lineage2 == 4)
recombinations_recent <- read.csv("~/Documents/2021-Fiji-Ct_paper/fastGEAR_withGlobal_189/recombinations_recent.txt", sep="") %>%
mutate(Length = End-Start+1)
