ggplot(R_C_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared R-C iSNPs") +
theme_bw()
R_vs_V_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
R_V_Shared_iSNPs <- R_vs_V_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
R_V_Shared_iSNPs_pos_count <- inner_join(R_V_Shared_iSNPs,Pos_count,by = "Position")
R_V_title <- paste("Minor SNPs in R(x) versus V(y). Total shared iSNPs = ",nrow(R_V_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(R_V_Shared_iSNPs_pos_count,n < 4)))
ggplot(R_vs_V_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = R_V_title)
ggplot(R_V_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared R-V iSNPs") +
theme_bw()
V_vs_C_iSNPs <- inner_join(V_MAP,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
V_C_Shared_iSNPs <- V_vs_C_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
V_C_Shared_iSNPs_pos_count <- inner_join(V_C_Shared_iSNPs,Pos_count,by = "Position")
V_C_title <- paste("Minor SNPs in V(x) versus C(y). Total shared iSNPs = ",nrow(V_C_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(V_C_Shared_iSNPs_pos_count,n < 4)))
ggplot(V_vs_C_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = V_C_title)
ggplot(V_C_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared V-C iSNPs") +
theme_bw()
#RC
R_C_iSNPs_global <- R_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RCplot <- ggplot(R_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
theme_bw()
#RV
R_V_iSNPs_global <- R_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RVplot <- ggplot(R_V_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
theme_bw()
#VC
V_C_iSNPs_global <- V_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
VCplot <- ggplot(V_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
theme_bw()
## cowplot
plot_grid(
RCplot, RVplot, VCplot,
labels = c("a","b","c")
)
library(cowplot)
#RC
R_C_iSNPs_global <- R_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RCplot <- ggplot(R_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
theme_bw()
#RV
R_V_iSNPs_global <- R_vs_V_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RVplot <- ggplot(R_V_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
theme_bw()
#VC
V_C_iSNPs_global <- V_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
VCplot <- ggplot(V_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
theme_bw()
## cowplot
plot_grid(
RCplot, RVplot, VCplot,
labels = c("a","b","c")
)
subject_id <- "1226"
library(tidyverse)
source("MAP_functions.R")
Pos_count <- read_delim("Pos_count.tsv")
rare_iSNPs <- Pos_count %>% filter(n<4) %>%
.$Position
common_iSNPs <- Pos_count %>% filter(n>3) %>%
.$Position
R_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"R_MAP.txt"),"R") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
C_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"C_MAP.txt"),"C") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
V_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"V_MAP.txt"),"V") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
R_vs_C_iSNPs <- inner_join(R_MAP,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
R_C_Shared_iSNPs <- R_vs_C_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
R_C_Shared_iSNPs_pos_count <- inner_join(R_C_Shared_iSNPs,Pos_count,by = "Position")
R_C_title <- paste("Minor SNPs in R(x) versus C(y). Total shared iSNPs = ",nrow(R_C_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(R_C_Shared_iSNPs_pos_count,n < 4)))
ggplot(R_vs_C_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = R_C_title)
ggplot(R_C_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared R-C iSNPs") +
theme_bw()
R_vs_V_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
R_V_Shared_iSNPs <- R_vs_V_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
R_V_Shared_iSNPs_pos_count <- inner_join(R_V_Shared_iSNPs,Pos_count,by = "Position")
R_V_title <- paste("Minor SNPs in R(x) versus V(y). Total shared iSNPs = ",nrow(R_V_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(R_V_Shared_iSNPs_pos_count,n < 4)))
ggplot(R_vs_V_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = R_V_title)
ggplot(R_V_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared R-V iSNPs") +
theme_bw()
V_vs_C_iSNPs <- inner_join(V_MAP,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
V_C_Shared_iSNPs <- V_vs_C_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
V_C_Shared_iSNPs_pos_count <- inner_join(V_C_Shared_iSNPs,Pos_count,by = "Position")
V_C_title <- paste("Minor SNPs in V(x) versus C(y). Total shared iSNPs = ",nrow(V_C_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(V_C_Shared_iSNPs_pos_count,n < 4)))
ggplot(V_vs_C_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = V_C_title)
ggplot(V_C_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared V-C iSNPs") +
theme_bw()
library(cowplot)
#RC
R_C_iSNPs_global <- R_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RCplot <- ggplot(R_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
theme_bw()
#RV
R_V_iSNPs_global <- R_vs_V_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RVplot <- ggplot(R_V_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
theme_bw()
#VC
V_C_iSNPs_global <- V_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
VCplot <- ggplot(V_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
theme_bw()
## cowplot
plot_grid(
RCplot, RVplot, VCplot,
labels = c("a","b","c")
)
seq (100,105)
seq(100,105)
seq(100,105) + seq(110,120)
paste(seq(100,105),seq(110,120))
seq(100,105),seq(110,120)
c(seq(100,105),seq(110,120))
library(tidyverse)
recent_reomb <- read.csv("~/Documents/2021-Fiji-Ct_paper/fastGEAR_With_Fiji_isolates_Only/recombinations_recent.txt", sep="") %>%
mutate(Length = End-Start+1)
recent_reomb %>%
filter(DonorLineage == 1) %>%
filter(RecipientStrain < 83) %>%
group_by(DonorLineage,Start,End,Length) %>%
summarise(y = list(StrainName))
recent_reomb %>%
filter(DonorLineage == 2) %>%
filter(RecipientStrain < 83) %>%
group_by(DonorLineage,Start,End,Length) %>%
summarise(y = list(StrainName))
fiji_recombs <- recent_reomb %>%
filter(RecipientStrain < 83) %>%
group_by(DonorLineage,Start,End,Length) %>%
summarise(y = list(StrainName)) %>%
unnest_wider(y)
view(fiji_recombs)
subject_id <- "1176"
library(tidyverse)
source("MAP_functions.R")
Pos_count <- read_delim("Pos_count.tsv")
R_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"R_MAP.txt"),"R") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
C_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"C_MAP.txt"),"C") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
V_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"V_MAP.txt"),"V") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
R_vs_C_iSNPs <- inner_join(R_MAP,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
R_C_Shared_iSNPs <- R_vs_C_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
R_C_Shared_iSNPs_pos_count <- inner_join(R_C_Shared_iSNPs,Pos_count,by = "Position")
R_C_title <- paste("Minor SNPs in R(x) versus C(y). Total shared iSNPs = ",nrow(R_C_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(R_C_Shared_iSNPs_pos_count,n < 4)))
ggplot(R_vs_C_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = R_C_title)
ggplot(R_C_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared R-C iSNPs") +
theme_bw()
R_vs_V_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
R_V_Shared_iSNPs <- R_vs_V_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
R_V_Shared_iSNPs_pos_count <- inner_join(R_V_Shared_iSNPs,Pos_count,by = "Position")
R_V_title <- paste("Minor SNPs in R(x) versus V(y). Total shared iSNPs = ",nrow(R_V_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(R_V_Shared_iSNPs_pos_count,n < 4)))
ggplot(R_vs_V_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = R_V_title)
ggplot(R_V_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared R-V iSNPs") +
theme_bw()
V_vs_C_iSNPs <- inner_join(V_MAP,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
V_C_Shared_iSNPs <- V_vs_C_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
V_C_Shared_iSNPs_pos_count <- inner_join(V_C_Shared_iSNPs,Pos_count,by = "Position")
V_C_title <- paste("Minor SNPs in V(x) versus C(y). Total shared iSNPs = ",nrow(V_C_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(V_C_Shared_iSNPs_pos_count,n < 4)))
ggplot(V_vs_C_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = V_C_title)
ggplot(V_C_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared V-C iSNPs") +
theme_bw()
library(cowplot)
#RC
R_C_iSNPs_global <- R_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RCplot <- ggplot(R_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
theme_bw()
#RV
R_V_iSNPs_global <- R_vs_V_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RVplot <- ggplot(R_V_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
theme_bw()
#VC
V_C_iSNPs_global <- V_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
VCplot <- ggplot(V_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
theme_bw()
## cowplot
plot_grid(
RCplot, RVplot, VCplot,
labels = c("a","b","c")
)
Total_iSNPs <- inner_join(R_MAP,V_MAP,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95 & SNP_percent.y > 95))
view(Total_iSNPs)
subject_id <- "1226"
library(tidyverse)
source("MAP_functions.R")
Pos_count <- read_delim("Pos_count.tsv")
rare_iSNPs <- Pos_count %>% filter(n<4) %>%
.$Position
common_iSNPs <- Pos_count %>% filter(n>3) %>%
.$Position
R_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"R_MAP.txt"),"R") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
C_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"C_MAP.txt"),"C") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
V_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"V_MAP.txt"),"V") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
R_vs_C_iSNPs <- inner_join(R_MAP,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
R_C_Shared_iSNPs <- R_vs_C_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
R_C_Shared_iSNPs_pos_count <- inner_join(R_C_Shared_iSNPs,Pos_count,by = "Position")
R_C_title <- paste("Minor SNPs in R(x) versus C(y). Total shared iSNPs = ",nrow(R_C_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(R_C_Shared_iSNPs_pos_count,n < 4)))
ggplot(R_vs_C_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = R_C_title)
ggplot(R_C_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared R-C iSNPs") +
theme_bw()
R_vs_V_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
R_V_Shared_iSNPs <- R_vs_V_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
R_V_Shared_iSNPs_pos_count <- inner_join(R_V_Shared_iSNPs,Pos_count,by = "Position")
R_V_title <- paste("Minor SNPs in R(x) versus V(y). Total shared iSNPs = ",nrow(R_V_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(R_V_Shared_iSNPs_pos_count,n < 4)))
ggplot(R_vs_V_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = R_V_title)
ggplot(R_V_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared R-V iSNPs") +
theme_bw()
V_vs_C_iSNPs <- inner_join(V_MAP,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95))
V_C_Shared_iSNPs <- V_vs_C_iSNPs %>%
filter(SNP_percent.x <= 90 & SNP_percent.x >= 10 & SNP_percent.y <= 90 & SNP_percent.y >= 10)
V_C_Shared_iSNPs_pos_count <- inner_join(V_C_Shared_iSNPs,Pos_count,by = "Position")
V_C_title <- paste("Minor SNPs in V(x) versus C(y). Total shared iSNPs = ",nrow(V_C_Shared_iSNPs)," Rare iSNPs = ",nrow(filter(V_C_Shared_iSNPs_pos_count,n < 4)))
ggplot(V_vs_C_iSNPs, aes(x=SNP_percent.x, y=SNP_percent.y)) +
geom_point() +
theme_bw() +
labs(title = V_C_title)
ggplot(V_C_Shared_iSNPs_pos_count,aes(n)) + geom_histogram(binwidth=1) +
xlab("n iSNPs") +
ylab("count") +
ggtitle("Global frequency of shared V-C iSNPs") +
theme_bw()
library(cowplot)
#RC
R_C_iSNPs_global <- R_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RCplot <- ggplot(R_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
theme_bw()
#RV
R_V_iSNPs_global <- R_vs_V_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
RVplot <- ggplot(R_V_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
theme_bw()
#VC
V_C_iSNPs_global <- V_vs_C_iSNPs %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
VCplot <- ggplot(V_C_iSNPs_global, aes(x=SNP_percent.x, y=SNP_percent.y, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
theme_bw()
## cowplot
plot_grid(
RCplot, RVplot, VCplot,
labels = c("a","b","c")
)
Total_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
inner_join(.,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95 & SNP_percent.y > 95))
view(Total_iSNPs)
Total_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
inner_join(.,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95 & SNP_percent > 95))
Total_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
inner_join(.,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95 & SNP_percent > 95)) %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
view(Total_iSNPs)
otal_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
inner_join(.,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95 & SNP_percent > 95)) %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
colnanmes(Total_iSNPs) <- c("Position","R_percent","V_percent","C_percent","SNP")
Total_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
inner_join(.,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 95 & SNP_percent.y > 95 & SNP_percent > 95)) %>%
mutate(SNP = case_when(
Position %in% rare_iSNPs ~ "rare iSNP",
Position %in% common_iSNPs ~ "common iSNP",
TRUE ~ "other SNP"
))
colnames(Total_iSNPs) <- c("Position","R_percent","V_percent","C_percent","SNP")
view(Total_iSNPs)
Total_iSNPs %>%
filter(R_percent < .9 & V_percent >= 0.9 & C_percent >= 0.9)
Total_iSNPs %>%
filter(R_percent < 90 & V_percent >= 90 & C_percent >= 90)
Total_iSNPs %>%
filter(R_percent < 90 & V_percent >= 90 & C_percent >= 90) %>%
group_by(SNP) %>%
tally()
colnames(Total_iSNPs) <- c("Position","R_percent","V_percent","C_percent","SNP")
#R only
Total_iSNPs %>%
filter(R_percent < 10 & V_percent >= 90 & C_percent >= 90) %>%
group_by(SNP) %>%
tally()
