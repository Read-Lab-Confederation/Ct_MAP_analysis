nrow()
Total_iSNPs %>%
filter(C_percent >= 10 & C_percent < 90 & V_percent >= 90 & R_percent >= 90) %>%
group_by(SNP) %>%
tally()
ConlyRI <- Total_iSNPs %>%
filter(C_percent >= 10 & C_percent < 90 & V_percent >= 90 & R_percent >= 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(V_percent < 10 & C_percent >= 90 & R_percent >= 90) %>%
group_by(SNP) %>%
tally()
VonlyF <- Total_iSNPs %>%
filter(V_percent < 10 & C_percent >= 90 & R_percent >= 90) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(V_percent >= 10 & V_percent < 90 & C_percent >= 90 & R_percent >= 90) %>%
group_by(SNP) %>%
tally()
VonlyRI <- Total_iSNPs %>%
filter(V_percent >= 10 & V_percent < 90 & C_percent >= 90 & R_percent >= 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(V_percent >= 90 & C_percent < 10 & R_percent < 10) %>%
group_by(SNP) %>%
tally()
RConlyF <- Total_iSNPs %>%
filter(V_percent >= 90 & C_percent < 10 & R_percent < 10) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(V_percent >= 90 & C_percent >= 10 & C_percent < 90 & R_percent >= 10 & R_percent < 90) %>%
group_by(SNP) %>%
tally()
RConlyRI <- Total_iSNPs %>%
filter(V_percent >= 90 & C_percent >= 10 & C_percent < 90 & R_percent >= 10 & R_percent < 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(C_percent >= 90 & V_percent < 10 & R_percent < 10) %>%
group_by(SNP) %>%
tally()
RVonlyF <- Total_iSNPs %>%
filter(C_percent >= 90 & V_percent < 10 & R_percent < 10) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(C_percent >= 90 & V_percent >= 10 & V_percent < 90 & R_percent >= 10 & R_percent < 90) %>%
group_by(SNP) %>%
tally()
RVonlyRI <- Total_iSNPs %>%
filter(C_percent >= 90 & V_percent >= 10 & V_percent < 90 & R_percent >= 10 & R_percent < 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(R_percent >= 90 & V_percent < 10 & C_percent < 10) %>%
group_by(SNP) %>%
tally()
VConlyF <- Total_iSNPs %>%
filter(R_percent >= 90 & V_percent < 10 & C_percent < 10) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(R_percent >= 90 & V_percent >= 10 & V_percent < 90 & C_percent >= 10 & C_percent < 90) %>%
group_by(SNP) %>%
tally()
VConlyRI <- Total_iSNPs %>%
filter(R_percent >= 90 & V_percent >= 10 & V_percent < 90 & C_percent >= 10 & C_percent < 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(R_percent <10 & V_percent < 10 & C_percent < 10) %>%
group_by(SNP) %>%
tally()
AllF <- Total_iSNPs %>%
filter(R_percent <10 & V_percent < 10 & C_percent < 10) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP" | SNP == "common_iSNP" ) %>%
nrow()
Total_iSNPs %>%
filter(R_percent >= 10 & R_percent < 90 & V_percent >= 10 & V_percent < 90 & C_percent >= 10 & C_percent < 90) %>%
group_by(SNP) %>%
tally()
AllRI <- Total_iSNPs %>%
filter(R_percent >= 10 & R_percent < 90 & V_percent >= 10 & V_percent < 90 & C_percent >= 10 & C_percent < 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
result_table <- data.frame(subject_name = subject_id,AllF,AllRI,RonlyF,RonlyRI,ConlyF,ConlyRI,VonlyF,VonlyRI,RConlyF,RConlyRI,RVonlyF,RVonlyRI,VConlyF,VConlyRI)
result_table
outfile <- paste0("./iSNP_analysis_table/iSNPs_",subject_id,".tsv")
write_tsv(result_table,outfile)
library(cowplot)
RCplot <- ggplot(filter(Total_iSNPs,!(R_percent > 90 & C_percent > 90)), aes(x=R_percent, y=C_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
RVplot <- ggplot(filter(Total_iSNPs,!(R_percent > 90 & V_percent > 90)), aes(x=R_percent, y=V_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
VCplot <- ggplot(filter(Total_iSNPs,!(V_percent > 90 & C_percent > 90)), aes(x=V_percent, y=C_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
## cowplot
plot_grid(
RCplot, RVplot, VCplot,
labels = c("a","b","c")
)
RCplot +
labs(title = paste("Minor SNPs in R(x) versus C(y). Subject:",subject_id))
RVplot +
labs(title = paste("Minor SNPs in R(x) versus V(y). Subject:",subject_id))
VCplot +
labs(title = paste("Minor SNPs in V(x) versus C(y). Subject:",subject_id))
subject_id <- "564"
library(tidyverse)
source("MAP_functions.R")
Pos_count <- read_delim("Pos_count.tsv", show_col_types = FALSE)
rare_iSNPs <- Pos_count %>% filter(n<4) %>%
.$Position
common_iSNPs <- Pos_count %>% filter(n>3) %>%
.$Position
recomb_coords <- function(fiji_df,samp_name){
tmp_df <- fiji_df %>%
filter(c1 == samp_name | c2 == samp_name) %>%
select(Start,End)
if (nrow(tmp_df)==0) {
return(vector())
}
else {
result <- vector()
for (i in 1:nrow(tmp_df)) {
result <- c(result,seq(tmp_df$Start[i],tmp_df$End[i]))
}
return(result)
}
}
fastgear_fiji_recombs <- read.delim("~/GitHub/Ct_MAP_analysis/fastgear_fiji_recombs") %>%
select(Start,End,...1,...2)
colnames(fastgear_fiji_recombs) <- c("Start","End","c1","c2")
R_name = paste0(subject_id,"R")
V_name = paste0(subject_id,"V")
C_name = paste0(subject_id,"C")
C_recomb <- recomb_coords(fastgear_fiji_recombs,C_name)
R_recomb <- recomb_coords(fastgear_fiji_recombs,R_name)
V_recomb <- recomb_coords(fastgear_fiji_recombs,V_name)
R_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"R_MAP.txt"),"R") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
C_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"C_MAP.txt"),"C") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
V_MAP <- read_MAP(paste0("~/Documents/2021-Fiji-Ct_paper/MAP_results/MAP_files/",subject_id,"V_MAP.txt"),"V") %>%
filter(regular > -1 & regular < 1) %>%
filter(Coverage > 10) %>%
select(Position,SNP_percent)
Total_iSNPs <- inner_join(R_MAP,V_MAP, by = "Position") %>%
inner_join(.,C_MAP, by = "Position") %>%
filter(!(SNP_percent.x > 90 & SNP_percent.y > 90 & SNP_percent > 90)) %>%
mutate(SNP = case_when(
Position %in% c(R_recomb,C_recomb,V_recomb) ~ "fastGEAR_block",
Position %in% rare_iSNPs ~ "rare_iSNP",
Position %in% common_iSNPs ~ "common_iSNP",
TRUE ~ "other_SNP"
))
colnames(Total_iSNPs) <- c("Position","R_percent","V_percent","C_percent","SNP")
Total_iSNPs %>%
filter(R_percent < 10 & V_percent >= 90 & C_percent >= 90) %>%
group_by(SNP) %>%
tally()
RonlyF <- Total_iSNPs %>%
filter(R_percent < 10 & V_percent >= 90 & C_percent >= 90) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(R_percent >= 10 & R_percent < 90 & V_percent >= 90 & C_percent >= 90) %>%
group_by(SNP) %>%
tally()
RonlyRI <- Total_iSNPs %>%
filter(R_percent >= 10 & R_percent < 90 & V_percent >= 90 & C_percent >= 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(C_percent < 10 & V_percent >= 90 & R_percent >= 90) %>%
group_by(SNP) %>%
tally()
ConlyF <- Total_iSNPs %>%
filter(C_percent < 10 & V_percent >= 90 & R_percent >= 90) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(C_percent >= 10 & C_percent < 90 & V_percent >= 90 & R_percent >= 90) %>%
group_by(SNP) %>%
tally()
ConlyRI <- Total_iSNPs %>%
filter(C_percent >= 10 & C_percent < 90 & V_percent >= 90 & R_percent >= 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(V_percent < 10 & C_percent >= 90 & R_percent >= 90) %>%
group_by(SNP) %>%
tally()
VonlyF <- Total_iSNPs %>%
filter(V_percent < 10 & C_percent >= 90 & R_percent >= 90) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(V_percent >= 10 & V_percent < 90 & C_percent >= 90 & R_percent >= 90) %>%
group_by(SNP) %>%
tally()
VonlyRI <- Total_iSNPs %>%
filter(V_percent >= 10 & V_percent < 90 & C_percent >= 90 & R_percent >= 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(V_percent >= 90 & C_percent < 10 & R_percent < 10) %>%
group_by(SNP) %>%
tally()
RConlyF <- Total_iSNPs %>%
filter(V_percent >= 90 & C_percent < 10 & R_percent < 10) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(V_percent >= 90 & C_percent >= 10 & C_percent < 90 & R_percent >= 10 & R_percent < 90) %>%
group_by(SNP) %>%
tally()
RConlyRI <- Total_iSNPs %>%
filter(V_percent >= 90 & C_percent >= 10 & C_percent < 90 & R_percent >= 10 & R_percent < 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(C_percent >= 90 & V_percent < 10 & R_percent < 10) %>%
group_by(SNP) %>%
tally()
RVonlyF <- Total_iSNPs %>%
filter(C_percent >= 90 & V_percent < 10 & R_percent < 10) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(C_percent >= 90 & V_percent >= 10 & V_percent < 90 & R_percent >= 10 & R_percent < 90) %>%
group_by(SNP) %>%
tally()
RVonlyRI <- Total_iSNPs %>%
filter(C_percent >= 90 & V_percent >= 10 & V_percent < 90 & R_percent >= 10 & R_percent < 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(R_percent >= 90 & V_percent < 10 & C_percent < 10) %>%
group_by(SNP) %>%
tally()
VConlyF <- Total_iSNPs %>%
filter(R_percent >= 90 & V_percent < 10 & C_percent < 10) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(R_percent >= 90 & V_percent >= 10 & V_percent < 90 & C_percent >= 10 & C_percent < 90) %>%
group_by(SNP) %>%
tally()
VConlyRI <- Total_iSNPs %>%
filter(R_percent >= 90 & V_percent >= 10 & V_percent < 90 & C_percent >= 10 & C_percent < 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
Total_iSNPs %>%
filter(R_percent <10 & V_percent < 10 & C_percent < 10) %>%
group_by(SNP) %>%
tally()
AllF <- Total_iSNPs %>%
filter(R_percent <10 & V_percent < 10 & C_percent < 10) %>%
filter(SNP == "other_SNP" | SNP == "rare_iSNP" | SNP == "common_iSNP" ) %>%
nrow()
Total_iSNPs %>%
filter(R_percent >= 10 & R_percent < 90 & V_percent >= 10 & V_percent < 90 & C_percent >= 10 & C_percent < 90) %>%
group_by(SNP) %>%
tally()
AllRI <- Total_iSNPs %>%
filter(R_percent >= 10 & R_percent < 90 & V_percent >= 10 & V_percent < 90 & C_percent >= 10 & C_percent < 90) %>%
filter(SNP == "rare_iSNP") %>%
nrow()
result_table <- data.frame(subject_name = subject_id,AllF,AllRI,RonlyF,RonlyRI,ConlyF,ConlyRI,VonlyF,VonlyRI,RConlyF,RConlyRI,RVonlyF,RVonlyRI,VConlyF,VConlyRI)
result_table
outfile <- paste0("./iSNP_analysis_table/iSNPs_",subject_id,".tsv")
write_tsv(result_table,outfile)
library(cowplot)
RCplot <- ggplot(filter(Total_iSNPs,!(R_percent > 90 & C_percent > 90)), aes(x=R_percent, y=C_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % cervical") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
RVplot <- ggplot(filter(Total_iSNPs,!(R_percent > 90 & V_percent > 90)), aes(x=R_percent, y=V_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % rectal") +
ylab("Ref allele % vaginal") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
VCplot <- ggplot(filter(Total_iSNPs,!(V_percent > 90 & C_percent > 90)), aes(x=V_percent, y=C_percent, color = SNP)) +
geom_point() +
xlab("Ref allele % vaginal") +
ylab("Ref allele % cervical") +
xlim(0,100) +
scale_color_manual(values = c("gainsboro","orange","red","blue")) +
theme_bw()
## cowplot
plot_grid(
RCplot, RVplot, VCplot,
labels = c("a","b","c")
)
RCplot +
labs(title = paste("Minor SNPs in R(x) versus C(y). Subject:",subject_id))
RVplot +
labs(title = paste("Minor SNPs in R(x) versus V(y). Subject:",subject_id))
VCplot +
labs(title = paste("Minor SNPs in V(x) versus C(y). Subject:",subject_id))
res_files <- list.files("./iSNP_analysis_table/")
res_files
library(tidyverse)
iSNPs_107 <- read.delim("~/GitHub/Ct_MAP_analysis/iSNP_analysis_table/iSNPs_107.tsv")
View(iSNPs_107)
res_files <- list.files("./iSNP_analysis_table/")
res_table <- read.delim(res_files[1])
res_files <- list.files("./iSNP_analysis_table/",full.names = T)
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[2])
res_files <- bind_rows(res_table,temp_df)
}
res_files <- list.files("./iSNP_analysis_table/",full.names = T)
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_files <- bind_rows(res_table,temp_df)
}
res_files <- list.files("./iSNP_analysis_table/",full.names = T)
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
View(res_table)
write_tsv(res_table,"./iSNP_analysis_table/all_results_table.tsv")
grand_summary <- read.delim("./2021_08_24-Grand_Summary - MAP_analysis_summary.tsv")
View(grand_summary)
res_table %>%
select(subject_id,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_id)
res_table %>%
select(subject_id,RonlyRI,ConlyRI,VonlyRI
res_table %>%
select(subject_id,RonlyRI,ConlyRI,VonlyRI)
res_table %>%
select(subject_id,RonlyRI,ConlyRI,VonlyRI)
res_table %>%
select(subject_id)
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_id)
library(tidyverse)
res_files <- list.files("./iSNP_analysis_table/",full.names = T)
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
write_tsv(res_table,"./iSNP_analysis_table/all_results_table.tsv")
grand_summary <- read.delim("./2021_08_24-Grand_Summary - MAP_analysis_summary.tsv")
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_id)
View(res_table)
rm(res_table)
res_files <- list.files("./iSNP_analysis_table/",full.names = T)
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
rm(res_table)
res_files <- list.files("./iSNP_analysis_table/iSNPs*",full.names = T)
res_table <- read.delim(res_files[1])
?list.files
res_files <- list.files("./iSNP_analysis_table/iSNPs.*",full.names = T)
res_files <- list.files("./iSNP_analysis_table/",full.names = T, pattern = "iSNP*")
res_table <- read.delim(res_files[1])
for (i in 2:length(res_files)){
temp_df <- read.delim(res_files[i])
res_table <- bind_rows(res_table,temp_df)
}
write_tsv(res_table,"./iSNP_analysis_table/all_results_table.tsv")
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI)
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_id)
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name)
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(sample_name = case.when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
))
library(tidyverse)
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(sample_name = case.when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
))
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(sample_name = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
))
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(sSample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,grand_summary, by = Sample)
res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(sSample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,grand_summary, by = "Sample")
RI_SNPs <- res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(sSample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
))
inner_join(RI_SNPs,grand_summary, by = "Sample")
View(RI_SNPs)
View(RI_SNPs)
RI_SNPs <- res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,grand_summary, by = "Sample")
View(RI_SNPs)
View(RI_SNPs)
ggplot(RI_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw()
mean_doc <- grand_summary %>%
select(Sample,Mean.depth.of.coverage)
RI_SNPs <- res_table %>%
select(subject_name,RonlyRI,ConlyRI,VonlyRI) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(RI_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of rare intermediate SNPs versus sample depth of coverage")
F_SNPs <- res_table %>%
select(subject_name,RonlyF,ConlyF,VonlyF) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyRI" ~ paste0(subject_name,"R"),
site == "ConlyRI" ~ paste0(subject_name,"C"),
site == "VonlyRI" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(F_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of rare intermediate SNPs versus sample depth of coverage")
F_SNPs <- res_table %>%
select(subject_name,RonlyF,ConlyF,VonlyF) %>%
gather("site","SNPs",-subject_name) %>%
mutate(Sample = case_when(site == "RonlyF" ~ paste0(subject_name,"R"),
site == "ConlyF" ~ paste0(subject_name,"C"),
site == "VonlyF" ~ paste0(subject_name,"V")
)) %>%
inner_join(.,mean_doc, by = "Sample")
ggplot(F_SNPs,aes(x=Mean.depth.of.coverage,y=SNPs)) +
geom_point()+
theme_bw() +
ggtitle("Numbers of rare intermediate SNPs versus sample depth of coverage")
View(F_SNPs)
